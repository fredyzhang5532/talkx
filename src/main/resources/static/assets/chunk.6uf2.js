var qo=Object.defineProperty,zo=Object.defineProperties;var jo=Object.getOwnPropertyDescriptors;var sn=Object.getOwnPropertySymbols;var or=Object.prototype.hasOwnProperty,sr=Object.prototype.propertyIsEnumerable;var ar=Math.pow,rr=(e,n,t)=>n in e?qo(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,R=(e,n)=>{for(var t in n||(n={}))or.call(n,t)&&rr(e,t,n[t]);if(sn)for(var t of sn(n))sr.call(n,t)&&rr(e,t,n[t]);return e},J=(e,n)=>zo(e,jo(n));var bt=(e,n)=>{var t={};for(var r in e)or.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&sn)for(var r of sn(e))n.indexOf(r)<0&&sr.call(e,r)&&(t[r]=e[r]);return t};var B=(e,n,t)=>new Promise((r,s)=>{var o=i=>{try{c(t.next(i))}catch(l){s(l)}},a=i=>{try{c(t.throw(i))}catch(l){s(l)}},c=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,a);c((t=t.apply(e,n)).next())});import{_ as Ve,g as te,o as X,a as K,e as M,f as ae,d as ve,h as jt,j as kt,k as Zt,l as lt,i as et,m as Et,n as Tr,p as Un,c as ce,q as Xe,s as Sr,t as tt,v as j,F as Ae,w as he,x as qe,y as $n,z as dn,A as Se,B as Je,C as Re,D as We,E as ht,G as Ut,H as Zo,I as Go,J as Xo,K as Yo,L as Ho,M as Qo,N as Ko,O as kr,P as Jo,Q as es,R as ts,S as cr,T as ns,U as rs,V as Er,W as qn,b as It,X as os,Y as Wt,Z as Vt,$ as ss,a0 as as,a1 as Rr,r as Ar,a2 as cs,a3 as Fr,a4 as an,a5 as kn,a6 as is,a7 as ls}from"./bundle.0.0.2.js?v=0.9994225010119648";import{I as An}from"./chunk.6uf22.js";import{i as us}from"./chunk.6uf24.js";import{N as ds,i as hs,I as fs,M as ps,T as vs,L as ms,u as gs,c as _s}from"./chunk.6uf25.js";import{T as ys,M as Dr}from"./chunk.6uf26.js";import{N as zn}from"./chunk.6uf23.js";import{N as ws}from"./chunk.6uf27.js";import{N as Cs}from"./chunk.6uf28.js";import{U as Ns}from"./chunk.6uf29.js";import{f as bs}from"./chunk.6uf30.js";import{N as Ms}from"./chunk.6uf31.js";import{U as Is,H as Ts}from"./chunk.6uf20.js";import{u as Ss}from"./chunk.6uf32.js";import{M as ks}from"./chunk.6uf33.js";import"./chunk.6uf34.js";import"./chunk.6uf35.js";import"./chunk.6uf36.js";import"./chunk.6uf37.js";import"./chunk.6uf38.js";import"./chunk.6uf39.js";import"./chunk.6uf21.js";const Es={key:0,class:"inset_wrapper"},Rs={class:"text_content"},As={__name:"InsetPupComp",props:["show","text"],emits:["update:show","close"],setup(e,{emit:n}){const t=e,r=n;te("");const s=()=>{r("update:show",!1),r("close")};return(o,a)=>t.show?(X(),K("div",Es,[M("div",{class:"title flex_b"},[a[0]||(a[0]=M("div",null,"选择的代码",-1)),M("div",{class:"close"},[M("span",{class:"iconfont icon-close",onClick:s})])]),M("div",Rs,[ae(ys,{type:"quize",text:t.text,mtype:"share"},null,8,["text"])])])):ve("",!0)}},Fs=Ve(As,[["__scopeId","data-v-fceac9e1"]]);const Ds={class:"title flex_b"},Ps={class:"right flex"},Os={class:"list_wrapper"},xs=["onClick"],Ls={class:"flex_sx_center"},Bs={class:"icon"},Ws=["src","alt"],Vs={class:"name"},Us={key:0,class:"tdot"},$s=["onClick"],qs={__name:"FriendList",setup(e){const n=jt(),t=kt(),r=te(null),s=Zt(),o=lt(),a=et("resize"),c=Et(),i=Tr(),{showToast:l,closeWatch:u,clearWatch:d}=Un(),h=i.appContext.config.globalProperties.$bus,p=te([]);ce(()=>n.name=="dialogue");const f=ce(()=>n.name=="d_friendsPlaza"),g=ce(()=>n.name=="d_friendsPlazaEdit"),_=ce(()=>n.query.userFriendId),C=ce(()=>n.query.fid),E=ce(()=>n.query.id),S=U=>B(this,null,function*(){U&&(yield o.setfriends()),p.value=o.friends.map(O=>J(R({},O),{showItem:!1}))}),x=U=>{const O=[{label:U.top?"取消置顶":"置顶",key:"top"}];return(U.friendType==1||U.friendType==3||U.friendType==4||U.friendType==5)&&(O.push({label:"编辑",key:"edit"}),O.push({label:"🤖 智体",key:"device"})),U.roleType!=="0"&&O.push({label:"删除",key:"del"}),O},I=()=>t.push({name:"d_friendsPlazaEdit"}),N=()=>t.push({name:"d_friendsPlaza"});let y;const w=()=>{if(y!==null){const U=document.querySelectorAll(".clickWrapper")[y];U&&U.click()}y=null},W=(U,O)=>{y=O},q=()=>{Ut(()=>{r.value&&(r.value.scrollTop=window.innerHeight)})},L=U=>B(this,null,function*(){if(console.log("friendFollow",U),U.__type=="edit"){const O=p.value.findIndex(m=>U.id==m.id);p.value[O]=U,V(U),q()}else if(U.__type=="add"){const O=J(R({},U),{showItem:!0});p.value.push(O),setTimeout(()=>{V(O),q()},100),O.showItem=!1,yield ht(300)}else{const O=J(R({},U),{showItem:!0});p.value.push(O),q(),O.showItem=!1,Ut(()=>{r.value&&(r.value.scrollTop=window.innerHeight)}),yield ht(300)}yield S(!0)});Xe(()=>{S(!0),h.on("friendFollow",L),u("del",O=>{O?A():T=!1}),setTimeout(()=>Sr("FriendList"),100)});let T=!1;const V=U=>B(this,null,function*(){if(T)return;T=!0,o.setFriend(U.friendId);const O={id:o.getCurrUid,fid:U.friendId};t.replace({name:"dialogue",query:O}),h.emit("friendChange"),T=!1});let b=null;const P=()=>B(this,null,function*(){if(!b)return;const U=+!b.top,O=yield Zo({friendId:b.friendId,isTop:U});if(O.errMsg){s.error(O.errMsg);return}s.success(U?"置顶成功":" 取消置顶成功"),S(!0)}),A=()=>B(this,null,function*(){if(!b)return;const U=yield Go({friendId:b.friendId});if(U.errMsg){T=!1,s.error(U.errMsg);return}s.success("删除成功"),S(!0),T=!1,V(p.value[0])}),Z=(U,O)=>B(this,null,function*(){if(!T)switch(T=!0,b=O,U){case"top":yield P(),T=!1;break;case"edit":t.push({name:"d_friendsPlazaEdit",query:{id:b.friendId}}),T=!1;break;case"device":t.push({name:"d_device",query:{id:b.friendId,userFriendId:b.userFriendId}}),T=!1;break;case"del":window.__talkx_event_stop=!0,l("del","你正在删除这个AI，历史话题也会随之删除，确定要这样做吗？");break}});return tt(()=>{d(),h.off("friendFollow",L)}),(U,O)=>(X(),K("div",{class:he(["FriendList",{small:j(a).smallRef.value}]),onScrollPassive:w,style:Re({height:j(a).smallRef.value?52+p.value.length*60+2+"px":"100%"})},[M("div",Ds,[O[0]||(O[0]=M("div",{class:"text"},"我的AI",-1)),M("div",Ps,[j(a).smallRef.value?ve("",!0):(X(),K(Ae,{key:0},[M("div",{onClick:I},[M("span",{class:he(["iconfont icon-user-add hover_bg3",{active:g.value&&!E.value}])},null,2)]),M("div",{onClick:N},[M("span",{class:he(["iconfont icon-fenleiorguangchangorqitatianchong hover_bg3",{active:f.value}])},null,2)])],64))])]),M("div",{class:"flist",ref_key:"flistRef",ref:r},[M("div",Os,[(X(!0),K(Ae,null,qe(p.value,(m,v)=>(X(),K("div",{class:he(["fitem flex_b",{active:_.value&&m.userFriendId==_.value||m.friendId==C.value||g.value&&m.friendId==E.value,showItem:m.showItem}]),key:m,onClick:F=>V(m)},[M("div",Ls,[M("div",Bs,[M("img",{src:m.avatar||j($n),alt:m.name},null,8,Ws)]),M("div",Vs,[m.top?(X(),K("span",Us)):ve("",!0),dn(" "+Se(m.name),1)])]),!j(o).sending&&j(c).isLogin?(X(),K("div",{key:0,class:"right",onClick:Je(F=>W(m,v),["stop"]),style:Re({opacity:j(a).smallRef.value?1:0})},[ae(j(ds),{trigger:j(a).smallRef.value?"click":"hover",placement:"right",options:x(m),onSelect:F=>Z(F,m)},{default:We(()=>O[1]||(O[1]=[M("div",{class:"clickWrapper"},[M("span",{class:"iconfont icon-option-vertical"})],-1)])),_:2},1032,["trigger","options","onSelect"])],12,$s)):ve("",!0)],10,xs))),128))])],512),O[2]||(O[2]=M("div",{class:"san"},null,-1))],38))}},Pr=Ve(qs,[["__scopeId","data-v-c290d913"]]);const zs={key:0,class:"userList"},js={class:"avater"},Zs=["src"],Gs={class:"name"},Xs={class:"list_wrapper"},Ys={class:"listWrraper"},Hs={__name:"FirendComp",setup(e){const n=lt(),t=ce(()=>n.currFriendInfo),r=te(!1),s=et("resize"),o=()=>{if(window.__talkx_event_stop){window.__talkx_event_stop=!1;return}r.value=!1};return Xe(()=>{document.addEventListener("click",o)}),tt(()=>{document.removeEventListener("click",o)}),(a,c)=>j(s).webSmallRef.value?(X(),K("div",zs,[ae(j(zn),{placement:"top-start",show:r.value,style:{padding:"4px","border-radius":"0px","background-color":"var(--tp_userList_bgcolor)"}},{trigger:We(()=>[M("div",{class:"currFriend",onClick:c[0]||(c[0]=Je(i=>r.value=!r.value,["stop"]))},[M("div",js,[M("img",{src:t.value.avatar||j($n)},null,8,Zs)]),M("div",Gs,Se(t.value.name),1),c[1]||(c[1]=M("div",null,[M("span",{class:"iconfont icon-xiangyoujiantou"})],-1))])]),default:We(()=>[M("div",Xs,[c[2]||(c[2]=M("div",{class:"san"},null,-1)),M("div",Ys,[ae(Pr)])])]),_:1},8,["show"])])):ve("",!0)}},Qs=Ve(Hs,[["__scopeId","data-v-4034a40a"]]);const Ks={class:"feature_row"},Js=["onClick"],ea={class:"icon"},ta={key:1,class:"division"},na={__name:"FeatureRow",props:["list","cursor"],emits:["itemClick"],setup(e,{emit:n}){kt(),Zt(),te(!1),et("resize");const t=e,r=n,{showToast:s,closeWatch:o,clearWatch:a}=Un(),c=p=>{r("itemClick",p)},i=te(!1),l=te([]),u=p=>{i.value=!1,c(J(R({},t.list[0]),{friend:p}))},d=()=>B(this,null,function*(){const f=(yield Xo({productType:1})).map(g=>({label:g.name,key:"item",props:{onClick:()=>u(g)},children:[{label:"编辑",key:"edit",data:g},{label:"删除",key:"del",data:g}]}));l.value=f,f.length&&l.value.push({type:"divider",key:"divider"}),l.value.push({label:"新建",key:"add"})}),h=()=>B(this,null,function*(){});return Xe(()=>{d(),o("del",p=>{p&&h()})}),tt(()=>a()),(p,f)=>(X(),K("div",Ks,[(X(!0),K(Ae,null,qe(t.list,(g,_)=>(X(),K(Ae,{key:_},[g.hide?ve("",!0):(X(),K("div",{key:0,class:"feature_item hover_light",tabindex:"0",onClick:C=>c(g),style:Re({cursor:e.cursor})},[ae(j(ws),{trigger:"hover"},{trigger:We(()=>[M("div",ea,[M("span",{class:he(["iconfont",g.icon])},null,2)])]),default:We(()=>[dn(" "+Se(g.text),1)]),_:2},1024)],12,Js)),g.line?(X(),K("div",ta)):ve("",!0)],64))),128))]))}},ra=Ve(na,[["__scopeId","data-v-e8776127"]]);const oa={class:"model_list"},sa={class:"tbody"},aa={class:"list"},ca=["onClick"],ia={class:"select"},la={class:"content flex"},ua={class:"left"},da={class:"name"},ha={class:"consume"},fa={class:"cTags flex"},pa={__name:"ModelList",props:["show"],emits:["update:show"],setup(e,{emit:n}){const t=n,r=Zt(),s=Et(),o=te([]);let a=!1;const c=ce(()=>{var u;return(u=s.user)==null?void 0:u.model}),i=()=>{t("update:show",!1)},l=u=>B(this,null,function*(){if(a||!u.canSelection)return;a=!0;const{errMsg:d}=yield s.setUser({field:"model",value:u.model});d?r.error(d):t("update:show",!1),a=!1});return Xe(()=>{Yo().then(u=>{o.value=u.map(d=>{const{commentTags:h=[]}=d;return Object.assign({},d,{commentTags:h.map(({color:p,bgColor:f,name:g})=>({name:g,style:{color:p,backgroundColor:f}}))})})})}),(u,d)=>(X(),K("div",oa,[M("div",{class:"head"},[d[1]||(d[1]=M("span",null,"模型",-1)),d[2]||(d[2]=M("span",null,"提问/回答",-1)),M("div",{class:"close",onClick:i},d[0]||(d[0]=[M("span",{class:"iconfont icon-close"},null,-1)]))]),M("div",sa,[M("div",aa,[(X(!0),K(Ae,null,qe(o.value,h=>(X(),K("div",{class:he(["item flex_sx_center",{disabled:!h.canSelection}]),key:h.id,onClick:p=>l(h)},[M("div",ia,[ae(j(Cs),{checked:h.model==c.value,disabled:!h.canSelection},null,8,["checked","disabled"])]),M("div",la,[M("div",ua,[M("div",da,Se(h.model),1),M("div",ha,Se(h.inputCoins>0?h.inputCoins:"免费")+"/"+Se(h.outputCoins>0?h.outputCoins:"免费"),1)]),M("div",fa,[(X(!0),K(Ae,null,qe([...h.commentTags],p=>(X(),K("div",{class:"tagItem",key:p.name,style:Re(p.style)},Se(p.name),5))),128))])])],10,ca))),128))])])]))}},va=Ve(pa,[["__scopeId","data-v-a7494b33"]]);const ma=["src"],ga={class:"list_wrapper"},_a={__name:"ModelComp",props:["showUpload"],setup(e){const n=lt(),t=Et(),r=te(!1),s=e,o=ce(()=>n.currFriendInfo),a=()=>{c.value.showModelSelect&&(r.value=!r.value)},c=ce(()=>t.user?(console.log(`current: ${JSON.stringify(o.value)}`),{model:o.value.fixedModel||t.user.model,icon:t.user.modelIcon,showModelSelect:o.value.showModelSelect,friendType:o.value.friendType}):{model:"",icon:"",showModelSelect:!1}),i=()=>{r.value=!1};return Xe(()=>{window.addEventListener("click",i)}),tt(()=>{window.removeEventListener("click",i)}),(l,u)=>(X(),K("div",{class:he(["model_wrapper",{showUpload:s.showUpload}]),style:Re({backgroundColor:c.value.showModelSelect?"var(--tp_d_filelist_bgColor)":"transparent"})},[ae(j(zn),{placement:"top-start",show:r.value,style:{padding:"4px","border-radius":"0px","background-color":"var(--tp_userList_bgcolor)"}},{trigger:We(()=>[M("div",null,[c.value&&c.value.friendType===1?(X(),K("div",{key:0,class:"model_text flex_sx_center",onClick:Je(a,["stop"]),style:Re({cursor:c.value.showModelSelect?"pointer":"not-allowed"})},[c.value.icon&&c.value.showModelSelect?(X(),K("img",{key:0,class:"model_icon",src:c.value.icon},null,8,ma)):ve("",!0),M("span",null,Se(c.value.model),1)],4)):ve("",!0)])]),default:We(()=>[M("div",ga,[ae(va,{show:r.value,"onUpdate:show":u[0]||(u[0]=d=>r.value=d)},null,8,["show"])])]),_:1},8,["show"])],6))}},ya=Ve(_a,[["__scopeId","data-v-720b0c6b"]]),ln=te(""),$t=te([]),qt=ce(()=>$t.value.map(e=>{const{name:n}=e,t=n.split("."),r=t[t.length-1];return J(R({},e),{type:Ho.includes(r)?"img":r,suffix:r})})),Or=[],wa=e=>Or.push(e),Ca=()=>{ln.value="",$t.value=[],Or.forEach(e=>e())};const Na={class:"upload_comp"},ba={__name:"UploadIcon",setup(e){const n=Zt(),t=te(null),r=()=>{if(!t.value)return;t.value.root().value.openOpenFileDialog()},s=a=>{$t.value=a},o=a=>{n.error(a)};return Xe(()=>{wa(()=>{var a;(a=t.value)==null||a.clear()})}),(a,c)=>(X(),K("div",Na,[ae(Ns,{ref_key:"uploadCompRef",ref:t,max:1/0,accept:j(Qo),showFileList:!1,onChange:s,triggerClass:"upload_icon",upLoadApi:"file",onError:o,imgs:j(ln),"onUpdate:imgs":c[0]||(c[0]=i=>Ko(ln)?ln.value=i:null)},null,8,["accept","imgs"]),M("span",{class:"iconfont icon-fujian",onClick:r})]))}};const Ma={class:"ul flex"},Ia=["src"],Ta={key:1,class:"other"},Sa={class:"text"},ka=["onClick"],Ea={__name:"BottomFileList",setup(e){const n=et("resize"),t=r=>{const s=$t.value.findIndex(o=>o.id==r.id);$t.value.splice(s,1)};return(r,s)=>j(qt).length?(X(),K("div",{key:0,class:he(["BottomFileList",{small:j(n).smallRef.value}])},[M("div",Ma,[(X(!0),K(Ae,null,qe(j(qt),o=>(X(),K("div",{class:he(["item",o.type]),key:o.url},[o.type=="img"?(X(),K("img",{key:0,src:o.url,alt:""},null,8,Ia)):(X(),K("div",Ta,s[0]||(s[0]=[M("span",{class:"iconfont icon-file"},null,-1)]))),M("span",Sa,Se(o.name),1),M("div",{class:"close",onClick:a=>t(o)},s[1]||(s[1]=[M("span",{class:"iconfont icon-close1"},null,-1)]),8,ka)],2))),128))])],2)):ve("",!0)}},Ra=Ve(Ea,[["__scopeId","data-v-389b4b0a"]]);function Aa(){const e=kr({show:!1,text:"",cbs:[]});return{inset:e,hideInsetArea:()=>{e.show=!1,e.text="",e.cbs=[]},showInsetArea:(s,o=()=>{})=>{e.show=!0,e.text=s,e.cbs.push(o)},insetClose:()=>{e.cbs.forEach(s=>s()),e.text="",e.cbs=[]}}}const be=lt(),xr=Et(),Fa=te(0),Da=te(null),Pa=te(!1),Rt=ce(()=>xr.isLogin),Oa=ce(()=>{let e=be.currChat.message;return be.isWeb&&(e=e.filter(n=>n.sessionId)),e.length<=0}),Lr=e=>e.map(n=>(n.chat.find(t=>t.role=="user")||n.chat.unshift({id:Math.random(),role:"user",sessionId:"",content:""}),n.chat.find(t=>t.role=="assistant")||n.chat.push({id:Math.random(),role:"assistant",sessionId:"",content:""}),n)),Br=e=>{var n=[],t=-1,r="";return e.forEach((s,o)=>{(e[r]&&e[r].role==s.role||!e[r]||s.role==="user")&&(t++,n[t]||(n[t]={chat:[]})),r=o,n[t].chat.push(J(R({},s),{__index:o}))}),n.forEach((s,o)=>{var c,i;let a=((c=s.chat[0])==null?void 0:c.sessionId)||((i=s.chat[1])==null?void 0:i.sessionId)||be.getCurrUid;s.id=a+o}),n},xa=ce(()=>{let e=Br(be.currChat.message);return e=Lr(e),e}),La=ce(()=>{let e=Br(be.isWeb?be.getFriendMsg():be.newTopicMsg());return e=Lr(e),e}),Ba=e=>B(void 0,null,function*(){return Rt.value?yield Jo(e):yield be.getSession(e).then(s=>{var o=s,{records:t}=o,r=bt(o,["records"]);return R({records:t.reverse()},r)})}),Wa=e=>B(void 0,null,function*(){return Rt.value?yield es(e):be.createLocaSession(e)}),Va=()=>B(void 0,null,function*(){Rt.value?yield ts(be.getCurrUid):be.deleteLocaSession(be.getCurrUid),be.removeChat(be.getCurrUid)}),Ua=e=>B(void 0,null,function*(){if(Rt.value){let n=0;const t=r=>B(void 0,null,function*(){if(!(n>=3)&&(n++,r.code==="ERR_NETWORK"))return yield cr(e).catch(s=>B(void 0,null,function*(){return yield t(s)}))});return yield cr(e).catch(r=>B(void 0,null,function*(){return console.log("save-assistant-err",r),yield t(r)}))}else return be.saveLocaMsg(e)}),$a=e=>B(void 0,null,function*(){Rt.value?yield ns(e):be.deleteLocaMsg(e)}),qa=(e={},n={})=>{be.addMsg(R({role:"user",content:""},e)),be.addMsg(R({role:"assistant",content:"",loading:!0},n))},za=(e,n)=>B(void 0,null,function*(){yield bs({messageId:e.chat[1].id});const t=document.querySelector(".MdList")||document.querySelector(".user_row"),r=n.target;rs(r,t)}),Wr={historyRef:Da,useChat:be,useLogin:xr,useLoca:Rt,isNew:Oa,newChatType:Fa,messageList:xa,delChat:Va,createChat:Wa,cellect:za,getChatMsg:Ba,saveChatMsg:Ua,delChatMsg:$a,addMsgGrounp:qa,newType1Data:La,isNewTopic:Pa};const ja={class:"top_row flex_b"},Za={class:"right flex"},Ga={key:0,class:"bottom_tip"},Xa=100,Ya={__name:"buttom",props:["sending","showVerbal","vShow"],emits:["send","stop","back","keydownEvent","update:sending"],setup(e,{expose:n,emit:t}){const r=J(R({},us),{fontSize:"14px","padding-bottom":"25px","--n-text-color":"var(--n-text-color)","--n-border":"1px solid var(--tp_bordecolor)","--n-border-disabled":"1px solid var(--tp_bordecolor)","--n-border-hover":"1px solid var(--tp_focus_bordecolor)","--n-border-focus":"1px solid var(--tp_focus_bordecolor)","--n-caret-color":"var(--tp_focus_bordecolor)"}),s=et("resize"),o=jt(),a=kt(),c=lt(),i=Et(),{featureConfig:l}=Er(),u=te(""),d=te(!1),h=te(!1),p=te(null),f=e,g=t;hs(p,u);const{inset:_,hideInsetArea:C,showInsetArea:E,insetClose:S}=Aa(),x=ce(()=>c.currFriendInfo),I=ce(()=>o.name=="d_friendsPlaza"),N=ce(()=>o.name=="d_friendsPlazaEdit");ce(()=>{var $;return($=i.user)==null?void 0:$.apiKey});const y=ce(()=>f.sending?"no-drop":"pointer"),w=ce(()=>l.map($=>J(R({},$),{icon:$.icon}))),W=ce(()=>{var $;return(($=i.user)==null?void 0:$.allowUpload)||x.value.friendType==2});qn(()=>{c.setText(u.value),u.value&&T(!!u.value,!0)});const q=()=>a.push({name:"d_friendsPlazaEdit"}),L=()=>a.push({name:"d_friendsPlaza"}),T=($,k)=>B(this,null,function*(){yield Ut(),!(!p.value||f.showVerbal&&f.vShow)&&k&&p.value.focus()}),V=()=>{h.value=!0,T()},b=()=>{h.value=!1,T(!!u.value)};let P=!1;const A=$=>{console.log("bottom-itemClick",$),!(f.sending||P)&&(P=!0,g("send",{type:"feature:execute-code-template:"+$.key,text:""}),setTimeout(()=>P=!1))};let Z=!1;const U=$=>{if(Z)return Z=!1,!1;$.preventDefault(),!(f.sending||!u.value||!u.value.trim())&&(g("update:sending",!0),g("send",{type:"text",text:u.value}),u.value="")},O=$=>{ss()||U($)},m=function($){Z=!1;const{shiftKey:k,ctrlKey:ee,altKey:oe,key:D,keyCode:se}=$;k&&D=="Enter"?Z=!0:ee&&(k||oe)&&se==68?g("keydownEvent",{type:"delCurrChat"}):ee&&(k||oe)&&se==67&&g("keydownEvent",{type:"addNew1"})},v=()=>g("stop");n({open:d,setText:$=>u.value=$,getText:$=>u.value,textareaUp:T,showInsetArea:E,hideInsetArea:C});const Q=te({"grid-template-columns":`repeat(auto-fill, ${Xa}px)`}),H=()=>{const $=window.innerWidth-40;let k=Math.floor($/100);const ee=w.value.length;k=k>ee?ee:k;const oe=$/k;Q.value["grid-template-columns"]=`repeat(auto-fill, ${oe}px)`};return s.change(H),Xe(()=>{T(!!u.value,!0),H(),setTimeout(()=>{Sr("bottom_area")},100)}),($,k)=>(X(),K("div",{class:he(["dialogue_buttom",{pc:!j(s).smallRef.value,small:j(s).smallRef.value,noBottom:!x.value.showModelSelect&&(j(s).mobileRef.value||j(s).smallRef.value)}])},[ae(Fs,{show:j(_).show,"onUpdate:show":k[0]||(k[0]=ee=>j(_).show=ee),text:j(_).text,onClose:j(S)},null,8,["show","text","onClose"]),M("div",ja,[M("div",null,[ae(Qs),j(l).length?(X(),It(ra,{key:0,cursor:y.value,list:j(l),onItemClick:A},null,8,["cursor","list"])):ve("",!0)]),M("div",Za,[j(s).webSmallRef.value?(X(),K(Ae,{key:0},[M("div",{class:"right_item aiItem",onClick:q},[M("span",{class:he(["iconfont icon-user-add hover_bg3",{active:N.value}])},null,2),k[2]||(k[2]=M("span",{class:"text"},"创建AI",-1))]),M("div",{class:"right_item aiItem square",onClick:L},[M("span",{class:he(["iconfont icon-fenleiorguangchangorqitatianchong hover_bg3",{active:I.value}])},null,2),k[3]||(k[3]=M("span",{class:"text"},"AI广场",-1))])],64)):ve("",!0)])]),M("div",{class:he(["input_area",{uploadFile:j(qt).length>0}])},[ae(Ra),ae(j(Ms),{type:"textarea",ref_key:"textareaRef",ref:p,value:u.value,"onUpdate:value":k[1]||(k[1]=ee=>u.value=ee),placeholder:"",disabled:f.sending,onKeypress:os(O,["enter"]),onKeydown:m,style:r,autosize:{minRows:1,maxRows:1},onFocus:V,onBlur:b},null,8,["value","disabled"]),M("div",{class:"send hover_bg2",tabindex:"0",onClick:U,style:Re({cursor:y.value})},[ae(j(An),{size:"20"},{default:We(()=>[ae(j(fs))]),_:1})],4),Wt(M("div",{class:"stop flex_sx_center",tabindex:"0",onClick:v},[ae(j(An),{size:"20",color:"#fff"},{default:We(()=>[ae(j(ps))]),_:1}),k[4]||(k[4]=M("span",{class:"text"},"停止回答",-1))],512),[[Vt,f.sending]]),ae(vs),W.value?(X(),It(ba,{key:0})):ve("",!0),ae(ya,{showUpload:W.value},null,8,["showUpload"])],2),j(s).smallRef.value?ve("",!0):(X(),K("div",Ga," TalkX 可能会犯错误，请检查重要信息。 "))],2))}},Ha=Ve(Ya,[["__scopeId","data-v-fb3a0fa4"]]);const Qa={class:"user_row"},Ka=["src"],Ja=["title"],ec={class:"listWrapper"},tc={__name:"UserRow",setup(e){const n=te(!1);lt();const t=Et(),r=ce(()=>t.user||{}),s=()=>n.value=!1,o=()=>n.value=!n.value;return Xe(()=>document.addEventListener("click",s)),tt(()=>document.removeEventListener("click",s)),(a,c)=>(X(),K("div",Qa,[ae(j(zn),{"show-arrow":!1,placement:"top-end",show:n.value,style:{padding:"4px","border-radius":"0px","background-color":"var(--tp_userList_bgcolor)"}},{trigger:We(()=>[M("div",{class:he(["user flex_sx_center",{active:n.value}]),onClick:Je(o,["stop"])},[M("img",{class:"avater",src:r.value.avatar||j(as)},null,8,Ka),M("div",{class:"name",title:r.value.name},Se(r.value.name||"未登录"),9,Ja)],2)]),default:We(()=>[M("div",ec,[ae(Is,{show:!0,"onUpdate:show":c[0]||(c[0]=i=>n.value=i)})])]),_:1},8,["show"])]))}},nc=e=>B(void 0,null,function*(){return Rr({url:"/voice/text_to_speech",method:"POST",RawData:!0,responseType:"blob",data:e})}),rc=e=>B(void 0,null,function*(){return Rr({url:"/voice/speech_to_text",method:"POST",type:"file","Content-type":"multipart/form-data;",data:e})});const oc={class:"NewTopic"},sc={__name:"NewTopic",setup(e){const{newType1Data:n,useChat:t}=Wr,r=te(t.sending),s=()=>{},o=()=>{};return(a,c)=>(X(),K("div",oc,[(X(!0),K(Ae,null,qe(j(n),(i,l)=>(X(),It(Dr,{key:l,item:i,sending:r.value,"onUpdate:sending":c[0]||(c[0]=u=>r.value=u),onChange:o,onDelmsg:s,end:l==j(n).length-1},null,8,["item","sending","end"]))),128))]))}};const ac={__name:"index",setup(e,{expose:n}){let t=Math.max(window.devicePixelRatio,2);const r=te(),s=(l,u,d,h)=>{l.clearRect(0,0,u.width,u.height);const p=u.width/2,f=u.height/2,g=["#C1F7F9","#A6ECEF","#7ED6D6","#409A9A"],_=E=>{let S=0;return E>=110?S=3:E>=90?S=2:E>=70&&(S=1),g[S]};for(var C=0;C<h.length;C+=4){const S=50+((h[C]+h[C+1]+h[C+2]+h[C+3])/4-128)*(50/128);l.beginPath(),l.lineWidth=1,l.arc(p,f,S*t,0,2*Math.PI,!1),l.strokeStyle=_(S),l.stroke()}};let o,a;return n({draw:({type:l,data:u})=>{r.value&&(a=r.value,a.height=parseFloat(getComputedStyle(a).height)*t,a.width=parseFloat(getComputedStyle(a).width)*t,o=a.getContext("2d"),o.imageSmoothingEnabled=!0,s(o,a,l,u))},clear:()=>{try{o&&o.clearRect(0,0,a.width,a.height)}catch(l){console.log("er",l)}}}),(l,u)=>(X(),K("canvas",{class:"VerbalCanvas",ref_key:"canvasRef",ref:r},null,512))}};const cc={__name:"index",props:["type"],setup(e,{expose:n}){let t="";const r=te([t]),s=te(!1);let o,a=()=>{};const c=()=>{const h=()=>clearInterval(o);return h(),o=setInterval(()=>{s.value=!s.value},2500),h},i=te(2.5),l=()=>B(this,null,function*(){yield ht(10),i.value=2.5,s.value=!0,a=c()}),u=()=>B(this,null,function*(){a(),s.value=!1,i.value=.3,yield ht(300)});return n({change:h=>B(this,null,function*(){t!=h&&(t=="noraml"?yield u():t=="loading"&&(r.value=[""],yield ht(300)),h=="noraml"?l():h=="loading"?r.value=["loading"]:h==""&&(r.value=[""]),t=h)})}),(h,p)=>(X(),K("div",{class:he(["breath",r.value])},[(X(),K(Ae,null,qe(8,f=>M("p",{key:f,class:he({scatter:s.value}),style:Re({"transition-duration":i.value+"s"})},null,6)),64))],2))}},ic=Ve(cc,[["__scopeId","data-v-7e355c80"]]),ir=(e,n,t)=>({endTime:n,insertTime:t,type:"exponentialRampToValue",value:e}),lr=(e,n,t)=>({endTime:n,insertTime:t,type:"linearRampToValue",value:e}),Fn=(e,n)=>({startTime:n,type:"setValue",value:e}),Vr=(e,n,t)=>({duration:t,startTime:n,type:"setValueCurve",values:e}),Ur=(e,n,{startTime:t,target:r,timeConstant:s})=>r+(n-r)*Math.exp((t-e)/s),Mt=e=>e.type==="exponentialRampToValue",hn=e=>e.type==="linearRampToValue",it=e=>Mt(e)||hn(e),jn=e=>e.type==="setValue",Qe=e=>e.type==="setValueCurve",fn=(e,n,t,r)=>{const s=e[n];return s===void 0?r:it(s)||jn(s)?s.value:Qe(s)?s.values[s.values.length-1]:Ur(t,fn(e,n-1,s.startTime,r),s)},ur=(e,n,t,r,s)=>t===void 0?[r.insertTime,s]:it(t)?[t.endTime,t.value]:jn(t)?[t.startTime,t.value]:Qe(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,fn(e,n-1,t.startTime,s)],Dn=e=>e.type==="cancelAndHold",Pn=e=>e.type==="cancelScheduledValues",ct=e=>Dn(e)||Pn(e)?e.cancelTime:Mt(e)||hn(e)?e.endTime:e.startTime,dr=(e,n,t,{endTime:r,value:s})=>t===s?s:0<t&&0<s||t<0&&s<0?t*ar(s/t,(e-n)/(r-n)):0,hr=(e,n,t,{endTime:r,value:s})=>t+(e-n)/(r-n)*(s-t),lc=(e,n)=>{const t=Math.floor(n),r=Math.ceil(n);return t===r?e[t]:(1-(n-t))*e[t]+(1-(r-n))*e[r]},uc=(e,{duration:n,startTime:t,values:r})=>{const s=(e-t)/n*(r.length-1);return lc(r,s)},cn=e=>e.type==="setTarget";class dc{constructor(n){this._automationEvents=[],this._currenTime=0,this._defaultValue=n}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(n){const t=ct(n);if(Dn(n)||Pn(n)){const r=this._automationEvents.findIndex(o=>Pn(n)&&Qe(o)?o.startTime+o.duration>=t:ct(o)>=t),s=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Dn(n)){const o=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&it(s)){if(o!==void 0&&cn(o))throw new Error("The internal list is malformed.");const a=o===void 0?s.insertTime:Qe(o)?o.startTime+o.duration:ct(o),c=o===void 0?this._defaultValue:Qe(o)?o.values[o.values.length-1]:o.value,i=Mt(s)?dr(t,a,c,s):hr(t,a,c,s),l=Mt(s)?ir(i,t,this._currenTime):lr(i,t,this._currenTime);this._automationEvents.push(l)}if(o!==void 0&&cn(o)&&this._automationEvents.push(Fn(this.getValue(t),t)),o!==void 0&&Qe(o)&&o.startTime+o.duration>t){const a=t-o.startTime,c=(o.values.length-1)/o.duration,i=Math.max(2,1+Math.ceil(a*c)),l=a/(i-1)*c,u=o.values.slice(0,i);if(l<1)for(let d=1;d<i;d+=1){const h=l*d%1;u[d]=o.values[d-1]*(1-h)+o.values[d]*h}this._automationEvents[this._automationEvents.length-1]=Vr(u,o.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>ct(a)>t),s=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(s!==void 0&&Qe(s)&&ct(s)+s.duration>t)return!1;const o=Mt(n)?ir(n.value,n.endTime,this._currenTime):hn(n)?lr(n.value,t,this._currenTime):n;if(r===-1)this._automationEvents.push(o);else{if(Qe(n)&&t+n.duration>ct(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(n){const t=this._automationEvents.findIndex(r=>ct(r)>n);if(t>1){const r=this._automationEvents.slice(t-1),s=r[0];cn(s)&&r.unshift(Fn(fn(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=r}}getValue(n){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>ct(a)>n),r=this._automationEvents[t],s=(t===-1?this._automationEvents.length:t)-1,o=this._automationEvents[s];if(o!==void 0&&cn(o)&&(r===void 0||!it(r)||r.insertTime>n))return Ur(n,fn(this._automationEvents,s-1,o.startTime,this._defaultValue),o);if(o!==void 0&&jn(o)&&(r===void 0||!it(r)))return o.value;if(o!==void 0&&Qe(o)&&(r===void 0||!it(r)||o.startTime+o.duration>n))return n<o.startTime+o.duration?uc(n,o):o.values[o.values.length-1];if(o!==void 0&&it(o)&&(r===void 0||!it(r)))return o.value;if(r!==void 0&&Mt(r)){const[a,c]=ur(this._automationEvents,s,o,r,this._defaultValue);return dr(n,a,c,r)}if(r!==void 0&&hn(r)){const[a,c]=ur(this._automationEvents,s,o,r,this._defaultValue);return hr(n,a,c,r)}return this._defaultValue}}const hc=e=>({cancelTime:e,type:"cancelAndHold"}),fc=e=>({cancelTime:e,type:"cancelScheduledValues"}),pc=(e,n)=>({endTime:n,type:"exponentialRampToValue",value:e}),vc=(e,n)=>({endTime:n,type:"linearRampToValue",value:e}),mc=(e,n,t)=>({startTime:n,target:e,timeConstant:t,type:"setTarget"}),gc=()=>new DOMException("","AbortError"),_c=e=>(n,t,[r,s,o],a)=>{e(n[s],[t,r,o],c=>c[0]===t&&c[1]===r,a)},yc=e=>(n,t,r)=>{const s=[];for(let o=0;o<r.numberOfInputs;o+=1)s.push(new Set);e.set(n,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},wc=e=>(n,t)=>{e.set(n,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Tt=new WeakSet,$r=new WeakMap,qr=new WeakMap,zr=new WeakMap,jr=new WeakMap,Zr=new WeakMap,Gr=new WeakMap,On=new WeakMap,fr=new WeakMap,Xr={construct(){return Xr}},Cc=e=>{try{const n=new Proxy(e,Xr);new n}catch(n){return!1}return!0},pr=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,vr=(e,n)=>{const t=[];let r=e.replace(/^[\s]+/,""),s=r.match(pr);for(;s!==null;){const o=s[1].slice(1,-1),a=s[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,n).toString());t.push(a),r=r.slice(s[0].length).replace(/^[\s]+/,""),s=r.match(pr)}return[t.join(";"),r]},mr=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},gr=e=>{if(!Cc(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Nc=(e,n,t,r,s,o,a,c,i,l,u,d,h)=>{let p=0;return(f,g,_={credentials:"omit"})=>{const C=u.get(f);if(C!==void 0&&C.has(g))return Promise.resolve();const E=l.get(f);if(E!==void 0){const I=E.get(g);if(I!==void 0)return I}const S=o(f),x=S.audioWorklet===void 0?s(g).then(([I,N])=>{const[y,w]=vr(I,N),W=`${y};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${w}
})})(window,'_AWGS')`;return t(W)}).then(()=>{const I=h._AWGS.pop();if(I===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>I(class{},void 0,(N,y)=>{if(N.trim()==="")throw n();const w=fr.get(S);if(w!==void 0){if(w.has(N))throw n();gr(y),mr(y.parameterDescriptors),w.set(N,y)}else gr(y),mr(y.parameterDescriptors),fr.set(S,new Map([[N,y]]))},S.sampleRate,void 0,void 0))}):Promise.all([s(g),Promise.resolve(e(d,d))]).then(([[I,N],y])=>{const w=p+1;p=w;const[W,q]=vr(I,N),b=`${W};((AudioWorkletProcessor,registerProcessor)=>{${q}
})(${y?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${y?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${y?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${w}',class extends AudioWorkletProcessor{process(){return !1}})`,P=new Blob([b],{type:"application/javascript; charset=utf-8"}),A=URL.createObjectURL(P);return S.audioWorklet.addModule(A,_).then(()=>{if(c(S))return S;const Z=a(S);return Z.audioWorklet.addModule(A,_).then(()=>Z)}).then(Z=>{if(i===null)throw new SyntaxError;try{new i(Z,`__sac${w}`)}catch(U){throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(A))});return E===void 0?l.set(f,new Map([[g,x]])):E.set(g,x),x.then(()=>{const I=u.get(f);I===void 0?u.set(f,new Set([g])):I.add(g)}).finally(()=>{const I=l.get(f);I!==void 0&&I.delete(g)}),x}},ut=(e,n)=>{const t=e.get(n);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},gn=(e,n)=>{const t=Array.from(e).filter(n);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return e.delete(r),r},Yr=(e,n,t,r)=>{const s=ut(e,n),o=gn(s,a=>a[0]===t&&a[1]===r);return s.size===0&&e.delete(n),o},Gt=e=>ut(Gr,e),St=e=>{if(Tt.has(e))throw new Error("The AudioNode is already stored.");Tt.add(e),Gt(e).forEach(n=>n(!0))},Hr=e=>"port"in e,Xt=e=>{if(!Tt.has(e))throw new Error("The AudioNode is not stored.");Tt.delete(e),Gt(e).forEach(n=>n(!1))},xn=(e,n)=>{!Hr(e)&&n.every(t=>t.size===0)&&Xt(e)},bc=(e,n,t,r,s,o,a,c,i,l,u,d,h)=>{const p=new WeakMap;return(f,g,_,C,E)=>{const{activeInputs:S,passiveInputs:x}=o(g),{outputs:I}=o(f),N=c(f),y=w=>{const W=i(g),q=i(f);if(w){const L=Yr(x,f,_,C);e(S,f,L,!1),!E&&!d(f)&&t(q,W,_,C),h(g)&&St(g)}else{const L=r(S,f,_,C);n(x,C,L,!1),!E&&!d(f)&&s(q,W,_,C);const T=a(g);if(T===0)u(g)&&xn(g,S);else{const V=p.get(g);V!==void 0&&clearTimeout(V),p.set(g,setTimeout(()=>{u(g)&&xn(g,S)},T*1e3))}}};return l(I,[g,_,C],w=>w[0]===g&&w[1]===_&&w[2]===C,!0)?(N.add(y),u(f)?e(S,f,[_,C,y],!0):n(x,C,[f,_,y],!0),!0):!1}},Mc=e=>(n,t,[r,s,o],a)=>{const c=n.get(r);c===void 0?n.set(r,new Set([[s,t,o]])):e(c,[s,t,o],i=>i[0]===s&&i[1]===t,a)},Ic=e=>(n,t)=>{const r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(n.destination);const s=()=>{t.removeEventListener("ended",s),t.disconnect(r),r.disconnect()};t.addEventListener("ended",s)},Tc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Sc=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=s(c),u=R(R({},Tc),i),d=r(l,u),h=o(l)?n():null;super(c,!1,d,h),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(c){this._nativeAnalyserNode.fftSize=c}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(c){const i=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=c,!(c>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=i,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(c){const i=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=c,!(this._nativeAnalyserNode.maxDecibels>c))throw this._nativeAnalyserNode.minDecibels=i,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(c){this._nativeAnalyserNode.smoothingTimeConstant=c}getByteFrequencyData(c){this._nativeAnalyserNode.getByteFrequencyData(c)}getByteTimeDomainData(c){this._nativeAnalyserNode.getByteTimeDomainData(c)}getFloatFrequencyData(c){this._nativeAnalyserNode.getFloatFrequencyData(c)}getFloatTimeDomainData(c){this._nativeAnalyserNode.getFloatTimeDomainData(c)}},De=(e,n)=>e.context===n,kc=(e,n,t)=>()=>{const r=new WeakMap,s=(o,a)=>B(void 0,null,function*(){let c=n(o);if(!De(c,a)){const l={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,fftSize:c.fftSize,maxDecibels:c.maxDecibels,minDecibels:c.minDecibels,smoothingTimeConstant:c.smoothingTimeConstant};c=e(a,l)}return r.set(a,c),yield t(o,a,c),c});return{render(o,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):s(o,a)}}},Ln=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch(n){return!1}return!0},pt=()=>new DOMException("","IndexSizeError"),Qr=e=>{e.getChannelData=(n=>t=>{try{return n.call(e,t)}catch(r){throw r.code===12?pt():r}})(e.getChannelData)},Ec={numberOfChannels:1},Rc=(e,n,t,r,s,o,a,c)=>{let i=null;return class Kr{constructor(u){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:h,sampleRate:p}=R(R({},Ec),u);i===null&&(i=new s(1,1,44100));const f=r!==null&&n(o,o)?new r({length:d,numberOfChannels:h,sampleRate:p}):i.createBuffer(h,d,p);if(f.numberOfChannels===0)throw t();return typeof f.copyFromChannel!="function"?(a(f),Qr(f)):n(Ln,()=>Ln(f))||c(f),e.add(f),f}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===Kr.prototype||e.has(u)}}},Le=-34028234663852886e22,Oe=-Le,Ke=e=>Tt.has(e),Ac={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Fc=(e,n,t,r,s,o,a,c)=>class extends e{constructor(l,u){const d=o(l),h=R(R({},Ac),u),p=s(d,h),f=a(d),g=f?n():null;super(l,!1,p,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=t(this,f,p.playbackRate,Oe,Le)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?c(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){St(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),Ke(this)&&Xt(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},Dc=(e,n,t,r,s)=>()=>{const o=new WeakMap;let a=null,c=null;const i=(l,u)=>B(void 0,null,function*(){let d=t(l);const h=De(d,u);if(!h){const p={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=n(u,p),a!==null&&d.start(...a),c!==null&&d.stop(c)}return o.set(u,d),h?yield e(u,l.playbackRate,d.playbackRate):yield r(u,l.playbackRate,d.playbackRate),yield s(l,u,d),d});return{set start(l){a=l},set stop(l){c=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):i(l,u)}}},Pc=e=>"playbackRate"in e,Oc=e=>"frequency"in e&&"gain"in e,xc=e=>"offset"in e,Lc=e=>!("frequency"in e)&&"gain"in e,Bc=e=>"detune"in e&&"frequency"in e&&!("gain"in e),Wc=e=>"pan"in e,Be=e=>ut($r,e),Yt=e=>ut(zr,e),Bn=(e,n)=>{const{activeInputs:t}=Be(e);t.forEach(s=>s.forEach(([o])=>{n.includes(e)||Bn(o,[...n,e])}));const r=Pc(e)?[e.playbackRate]:Hr(e)?Array.from(e.parameters.values()):Oc(e)?[e.Q,e.detune,e.frequency,e.gain]:xc(e)?[e.offset]:Lc(e)?[e.gain]:Bc(e)?[e.detune,e.frequency]:Wc(e)?[e.pan]:[];for(const s of r){const o=Yt(s);o!==void 0&&o.activeInputs.forEach(([a])=>Bn(a,n))}Ke(e)&&Xt(e)},Vc=e=>{Bn(e.destination,[])},Uc=e=>e===void 0||typeof e=="number"||typeof e=="string"&&(e==="balanced"||e==="interactive"||e==="playback"),$c=(e,n,t,r,s,o,a,c,i)=>class extends e{constructor(u={}){if(i===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new i(u)}catch(f){throw f.code===12&&f.message==="sampleRate is not in range"?t():f}if(d===null)throw r();if(!Uc(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw t();super(d,2);const{latencyHint:h}=u,{sampleRate:p}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:h==="balanced"?512/p:h==="interactive"||h===void 0?256/p:h==="playback"?1024/p:Math.max(2,Math.min(128,Math.round(h*p/128)))*128/p,this._nativeAudioContext=d,i.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const f=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",f)};d.addEventListener("statechange",f)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw n()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Vc(this)}))}createMediaElementSource(u){return new s(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new c(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const h=()=>{this._nativeAudioContext.removeEventListener("statechange",h),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",h)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?n():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?n():u})}},qc=(e,n,t,r,s,o,a,c)=>class extends e{constructor(l,u){const d=o(l),h=a(d),p=s(d,u,h),f=h?n(c):null;super(l,!1,p,f),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},zc=e=>{const n=new WeakMap,t=(r,s)=>B(void 0,null,function*(){const o=s.destination;return n.set(s,o),yield e(r,s,o),o});return{render(r,s){const o=n.get(s);return o!==void 0?Promise.resolve(o):t(r,s)}}},jc=(e,n,t,r,s,o,a,c)=>(i,l)=>{const u=l.listener,d=()=>{const I=new Float32Array(1),N=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),y=a(l);let w=!1,W=[0,0,-1,0,1,0],q=[0,0,0];const L=()=>{if(w)return;w=!0;const P=r(l,256,9,0);P.onaudioprocess=({inputBuffer:A})=>{const Z=[o(A,I,0),o(A,I,1),o(A,I,2),o(A,I,3),o(A,I,4),o(A,I,5)];Z.some((O,m)=>O!==W[m])&&(u.setOrientation(...Z),W=Z);const U=[o(A,I,6),o(A,I,7),o(A,I,8)];U.some((O,m)=>O!==q[m])&&(u.setPosition(...U),q=U)},N.connect(P)},T=P=>A=>{A!==W[P]&&(W[P]=A,u.setOrientation(...W))},V=P=>A=>{A!==q[P]&&(q[P]=A,u.setPosition(...q))},b=(P,A,Z)=>{const U=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:A});U.connect(N,0,P),U.start(),Object.defineProperty(U.offset,"defaultValue",{get(){return A}});const O=e({context:i},y,U.offset,Oe,Le);return c(O,"value",m=>()=>m.call(O),m=>v=>{try{m.call(O,v)}catch(F){if(F.code!==9)throw F}L(),y&&Z(v)}),O.cancelAndHoldAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.cancelAndHoldAtTime),O.cancelScheduledValues=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.cancelScheduledValues),O.exponentialRampToValueAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.exponentialRampToValueAtTime),O.linearRampToValueAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.linearRampToValueAtTime),O.setTargetAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.setTargetAtTime),O.setValueAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.setValueAtTime),O.setValueCurveAtTime=(m=>y?()=>{throw s()}:(...v)=>{const F=m.apply(O,v);return L(),F})(O.setValueCurveAtTime),O};return{forwardX:b(0,0,T(0)),forwardY:b(1,0,T(1)),forwardZ:b(2,-1,T(2)),positionX:b(6,0,V(0)),positionY:b(7,0,V(1)),positionZ:b(8,0,V(2)),upX:b(3,0,T(3)),upY:b(4,1,T(4)),upZ:b(5,0,T(5))}},{forwardX:h,forwardY:p,forwardZ:f,positionX:g,positionY:_,positionZ:C,upX:E,upY:S,upZ:x}=u.forwardX===void 0?d():u;return{get forwardX(){return h},get forwardY(){return p},get forwardZ(){return f},get positionX(){return g},get positionY(){return _},get positionZ(){return C},get upX(){return E},get upY(){return S},get upZ(){return x}}},pn=e=>"context"in e,Ht=e=>pn(e[0]),vt=(e,n,t,r)=>{for(const s of e)if(t(s)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(n),!0},_r=(e,n,[t,r],s)=>{vt(e,[n,t,r],o=>o[0]===n&&o[1]===t,s)},yr=(e,[n,t,r],s)=>{const o=e.get(n);o===void 0?e.set(n,new Set([[t,r]])):vt(o,[t,r],a=>a[0]===t,s)},At=e=>"inputs"in e,vn=(e,n,t,r)=>{if(At(n)){const s=n.inputs[r];return e.connect(s,t,0),[s,t,0]}return e.connect(n,t,r),[n,t,r]},Jr=(e,n,t)=>{for(const r of e)if(r[0]===n&&r[1]===t)return e.delete(r),r;return null},Zc=(e,n,t)=>gn(e,r=>r[0]===n&&r[1]===t),eo=(e,n)=>{if(!Gt(e).delete(n))throw new Error("Missing the expected event listener.")},to=(e,n,t)=>{const r=ut(e,n),s=gn(r,o=>o[0]===t);return r.size===0&&e.delete(n),s},mn=(e,n,t,r)=>{At(n)?e.disconnect(n.inputs[r],t,0):e.disconnect(n,t,r)},ge=e=>ut(qr,e),zt=e=>ut(jr,e),ft=e=>On.has(e),un=e=>!Tt.has(e),wr=(e,n)=>new Promise(t=>{if(n!==null)t(!0);else{const r=e.createScriptProcessor(256,1,1),s=e.createGain(),o=e.createBuffer(1,2,44100),a=o.getChannelData(0);a[0]=1,a[1]=1;const c=e.createBufferSource();c.buffer=o,c.loop=!0,c.connect(r).connect(e.destination),c.connect(s),c.disconnect(s),r.onaudioprocess=i=>{const l=i.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),c.stop(),r.onaudioprocess=null,c.disconnect(r),r.disconnect(e.destination)},c.start()}}),En=(e,n)=>{const t=new Map;for(const r of e)for(const s of r){const o=t.get(s);t.set(s,o===void 0?1:o+1)}t.forEach((r,s)=>n(s,r))},Cr=e=>"context"in e,Gc=e=>{const n=new Map;e.connect=(t=>(r,s=0,o=0)=>{const a=Cr(r)?t(r,s,o):t(r,s),c=n.get(r);return c===void 0?n.set(r,[{input:o,output:s}]):c.every(i=>i.input!==o||i.output!==s)&&c.push({input:o,output:s}),a})(e.connect.bind(e)),e.disconnect=(t=>(r,s,o)=>{if(t.apply(e),r===void 0)n.clear();else if(typeof r=="number")for(const[a,c]of n){const i=c.filter(l=>l.output!==r);i.length===0?n.delete(a):n.set(a,i)}else if(n.has(r))if(s===void 0)n.delete(r);else{const a=n.get(r);if(a!==void 0){const c=a.filter(i=>i.output!==s&&(i.input!==o||o===void 0));c.length===0?n.delete(r):n.set(r,c)}}for(const[a,c]of n)c.forEach(i=>{Cr(a)?e.connect(a,i.output,i.input):e.connect(a,i.output)})})(e.disconnect)},Xc=(e,n,t,r)=>{const{activeInputs:s,passiveInputs:o}=Yt(n),{outputs:a}=Be(e),c=Gt(e),i=l=>{const u=ge(e),d=zt(n);if(l){const h=to(o,e,t);_r(s,e,h,!1),!r&&!ft(e)&&u.connect(d,t)}else{const h=Zc(s,e,t);yr(o,h,!1),!r&&!ft(e)&&u.disconnect(d,t)}};return vt(a,[n,t],l=>l[0]===n&&l[1]===t,!0)?(c.add(i),Ke(e)?_r(s,e,[t,i],!0):yr(o,[e,t,i],!0),!0):!1},Yc=(e,n,t,r)=>{const{activeInputs:s,passiveInputs:o}=Be(n),a=Jr(s[r],e,t);return a===null?[Yr(o,e,t,r)[2],!1]:[a[2],!0]},Hc=(e,n,t)=>{const{activeInputs:r,passiveInputs:s}=Yt(n),o=Jr(r,e,t);return o===null?[to(s,e,t)[1],!1]:[o[2],!0]},Zn=(e,n,t,r,s)=>{const[o,a]=Yc(e,t,r,s);if(o!==null&&(eo(e,o),a&&!n&&!ft(e)&&mn(ge(e),ge(t),r,s)),Ke(t)){const{activeInputs:c}=Be(t);xn(t,c)}},Gn=(e,n,t,r)=>{const[s,o]=Hc(e,t,r);s!==null&&(eo(e,s),o&&!n&&!ft(e)&&ge(e).disconnect(zt(t),r))},Qc=(e,n)=>{const t=Be(e),r=[];for(const s of t.outputs)Ht(s)?Zn(e,n,...s):Gn(e,n,...s),r.push(s[0]);return t.outputs.clear(),r},Kc=(e,n,t)=>{const r=Be(e),s=[];for(const o of r.outputs)o[1]===t&&(Ht(o)?Zn(e,n,...o):Gn(e,n,...o),s.push(o[0]),r.outputs.delete(o));return s},Jc=(e,n,t,r,s)=>{const o=Be(e);return Array.from(o.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(s===void 0||a[2]===s)).map(a=>(Ht(a)?Zn(e,n,...a):Gn(e,n,...a),o.outputs.delete(a),a[0]))},ei=(e,n,t,r,s,o,a,c,i,l,u,d,h,p,f,g)=>class extends l{constructor(C,E,S,x){super(S),this._context=C,this._nativeAudioNode=S;const I=u(C);d(I)&&t(wr,()=>wr(I,g))!==!0&&Gc(S),qr.set(this,S),Gr.set(this,new Set),C.state!=="closed"&&E&&St(this),e(this,x,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(C){this._nativeAudioNode.channelCount=C}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(C){this._nativeAudioNode.channelCountMode=C}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(C){this._nativeAudioNode.channelInterpretation=C}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(C,E=0,S=0){if(E<0||E>=this._nativeAudioNode.numberOfOutputs)throw s();const x=u(this._context),I=f(x);if(h(C)||p(C))throw o();if(pn(C)){const w=ge(C);try{const q=vn(this._nativeAudioNode,w,E,S),L=un(this);(I||L)&&this._nativeAudioNode.disconnect(...q),this.context.state!=="closed"&&!L&&un(C)&&St(C)}catch(q){throw q.code===12?o():q}if(n(this,C,E,S,I)){const q=i([this],C);En(q,r(I))}return C}const N=zt(C);if(N.name==="playbackRate"&&N.maxValue===1024)throw a();try{this._nativeAudioNode.connect(N,E),(I||un(this))&&this._nativeAudioNode.disconnect(N,E)}catch(w){throw w.code===12?o():w}if(Xc(this,C,E,I)){const w=i([this],C);En(w,r(I))}}disconnect(C,E,S){let x;const I=u(this._context),N=f(I);if(C===void 0)x=Qc(this,N);else if(typeof C=="number"){if(C<0||C>=this.numberOfOutputs)throw s();x=Kc(this,N,C)}else{if(E!==void 0&&(E<0||E>=this.numberOfOutputs)||pn(C)&&S!==void 0&&(S<0||S>=C.numberOfInputs))throw s();if(x=Jc(this,N,C,E,S),x.length===0)throw o()}for(const y of x){const w=i([this],y);En(w,c)}}},ti=(e,n,t,r,s,o,a,c,i,l,u,d,h)=>(p,f,g,_=null,C=null)=>{const E=g.value,S=new dc(E),x=f?r(S):null,I={get defaultValue(){return E},get maxValue(){return _===null?g.maxValue:_},get minValue(){return C===null?g.minValue:C},get value(){return g.value},set value(N){g.value=N,I.setValueAtTime(N,p.context.currentTime)},cancelAndHoldAtTime(N){if(typeof g.cancelAndHoldAtTime=="function")x===null&&S.flush(p.context.currentTime),S.add(s(N)),g.cancelAndHoldAtTime(N);else{const y=Array.from(S).pop();x===null&&S.flush(p.context.currentTime),S.add(s(N));const w=Array.from(S).pop();g.cancelScheduledValues(N),y!==w&&w!==void 0&&(w.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(w.value,w.endTime):w.type==="linearRampToValue"?g.linearRampToValueAtTime(w.value,w.endTime):w.type==="setValue"?g.setValueAtTime(w.value,w.startTime):w.type==="setValueCurve"&&g.setValueCurveAtTime(w.values,w.startTime,w.duration))}return I},cancelScheduledValues(N){return x===null&&S.flush(p.context.currentTime),S.add(o(N)),g.cancelScheduledValues(N),I},exponentialRampToValueAtTime(N,y){if(N===0)throw new RangeError;if(!Number.isFinite(y)||y<0)throw new RangeError;const w=p.context.currentTime;return x===null&&S.flush(w),Array.from(S).length===0&&(S.add(l(E,w)),g.setValueAtTime(E,w)),S.add(a(N,y)),g.exponentialRampToValueAtTime(N,y),I},linearRampToValueAtTime(N,y){const w=p.context.currentTime;return x===null&&S.flush(w),Array.from(S).length===0&&(S.add(l(E,w)),g.setValueAtTime(E,w)),S.add(c(N,y)),g.linearRampToValueAtTime(N,y),I},setTargetAtTime(N,y,w){return x===null&&S.flush(p.context.currentTime),S.add(i(N,y,w)),g.setTargetAtTime(N,y,w),I},setValueAtTime(N,y){return x===null&&S.flush(p.context.currentTime),S.add(l(N,y)),g.setValueAtTime(N,y),I},setValueCurveAtTime(N,y,w){const W=N instanceof Float32Array?N:new Float32Array(N);if(d!==null&&d.name==="webkitAudioContext"){const q=y+w,L=p.context.sampleRate,T=Math.ceil(y*L),V=Math.floor(q*L),b=V-T,P=new Float32Array(b);for(let Z=0;Z<b;Z+=1){const U=(W.length-1)/w*((T+Z)/L-y),O=Math.floor(U),m=Math.ceil(U);P[Z]=O===m?W[O]:(1-(U-O))*W[O]+(1-(m-U))*W[m]}x===null&&S.flush(p.context.currentTime),S.add(u(P,y,w)),g.setValueCurveAtTime(P,y,w);const A=V/L;A<q&&h(I,P[P.length-1],A),h(I,W[W.length-1],q)}else x===null&&S.flush(p.context.currentTime),S.add(u(W,y,w)),g.setValueCurveAtTime(W,y,w);return I}};return t.set(I,g),n.set(I,p),e(I,x),I},ni=e=>({replay(n){for(const t of e)if(t.type==="exponentialRampToValue"){const{endTime:r,value:s}=t;n.exponentialRampToValueAtTime(s,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:s}=t;n.linearRampToValueAtTime(s,r)}else if(t.type==="setTarget"){const{startTime:r,target:s,timeConstant:o}=t;n.setTargetAtTime(s,r,o)}else if(t.type==="setValue"){const{startTime:r,value:s}=t;n.setValueAtTime(s,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:s,values:o}=t;n.setValueCurveAtTime(o,s,r)}else throw new Error("Can't apply an unknown automation.")}}),ri=(e,n,t,r,s,o,a,c,i,l,u,d,h,p,f,g,_,C,E,S)=>class extends f{constructor(I,N){super(I,N),this._nativeContext=I,this._audioWorklet=e===void 0?void 0:{addModule:(y,w)=>e(this,y,w)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new n(this)}createBiquadFilter(){return new s(this)}createBuffer(I,N,y){return new t({length:N,numberOfChannels:I,sampleRate:y})}createBufferSource(){return new r(this)}createChannelMerger(I=6){return new o(this,{numberOfInputs:I})}createChannelSplitter(I=6){return new a(this,{numberOfOutputs:I})}createConstantSource(){return new c(this)}createConvolver(){return new i(this)}createDelay(I=1){return new u(this,{maxDelayTime:I})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(I,N){return new p(this,{feedback:N,feedforward:I})}createOscillator(){return new g(this)}createPanner(){return new _(this)}createPeriodicWave(I,N,y={disableNormalization:!1}){return new C(this,J(R({},y),{imag:N,real:I}))}createStereoPanner(){return new E(this)}createWaveShaper(){return new S(this)}decodeAudioData(I,N,y){return l(this._nativeContext,I).then(w=>(typeof N=="function"&&N(w),w),w=>{throw typeof y=="function"&&y(w),w})}},oi={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},si=(e,n,t,r,s,o,a,c)=>class extends e{constructor(l,u){const d=o(l),h=R(R({},oi),u),p=s(d,h),f=a(d),g=f?t():null;super(l,!1,p,g),this._Q=n(this,f,p.Q,Oe,Le),this._detune=n(this,f,p.detune,1200*Math.log2(Oe),-1200*Math.log2(Oe)),this._frequency=n(this,f,p.frequency,l.sampleRate/2,0),this._gain=n(this,f,p.gain,40*Math.log10(Oe),Le),this._nativeBiquadFilterNode=p,c(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(h){throw h.code===11?r():h}if(l.length!==u.length||u.length!==d.length)throw r()}},ai=(e,n,t,r,s)=>()=>{const o=new WeakMap,a=(c,i)=>B(void 0,null,function*(){let l=t(c);const u=De(l,i);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=n(i,d)}return o.set(i,l),u?(yield e(i,c.Q,l.Q),yield e(i,c.detune,l.detune),yield e(i,c.frequency,l.frequency),yield e(i,c.gain,l.gain)):(yield r(i,c.Q,l.Q),yield r(i,c.detune,l.detune),yield r(i,c.frequency,l.frequency),yield r(i,c.gain,l.gain)),yield s(c,i,l),l});return{render(c,i){const l=o.get(i);return l!==void 0?Promise.resolve(l):a(c,i)}}},ci=(e,n)=>(t,r)=>{const s=n.get(t);if(s!==void 0)return s;const o=e.get(t);if(o!==void 0)return o;try{const a=r();return a instanceof Promise?(e.set(t,a),a.catch(()=>!1).then(c=>(e.delete(t),n.set(t,c),c))):(n.set(t,a),a)}catch(a){return n.set(t,!1),!1}},ii={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},li=(e,n,t,r,s)=>class extends e{constructor(a,c){const i=r(a),l=R(R({},ii),c),u=t(i,l),d=s(i)?n():null;super(a,!1,u,d)}},ui=(e,n,t)=>()=>{const r=new WeakMap,s=(o,a)=>B(void 0,null,function*(){let c=n(o);if(!De(c,a)){const l={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfInputs:c.numberOfInputs};c=e(a,l)}return r.set(a,c),yield t(o,a,c),c});return{render(o,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):s(o,a)}}},di={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},hi=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=r(c),u=o(R(R({},di),i)),d=t(l,u),h=s(l)?n():null;super(c,!1,d,h)}},fi=(e,n,t)=>()=>{const r=new WeakMap,s=(o,a)=>B(void 0,null,function*(){let c=n(o);if(!De(c,a)){const l={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfOutputs:c.numberOfOutputs};c=e(a,l)}return r.set(a,c),yield t(o,a,c),c});return{render(o,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):s(o,a)}}},pi=e=>(n,t,r)=>e(t,n,r),vi=e=>(n,t)=>{const r=e(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=n.createBuffer(1,2,44100);return r.buffer=s,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},mi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},gi=(e,n,t,r,s,o,a)=>class extends e{constructor(i,l){const u=s(i),d=R(R({},mi),l),h=r(u,d),p=o(u),f=p?t():null;super(i,!1,h,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=h,this._offset=n(this,p,h.offset,Oe,Le),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(i){const l=typeof i=="function"?a(this,i):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?i:u}start(i=0){if(this._nativeConstantSourceNode.start(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=i),this.context.state!=="closed"){St(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Ke(this)&&Xt(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(i=0){this._nativeConstantSourceNode.stop(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=i)}},_i=(e,n,t,r,s)=>()=>{const o=new WeakMap;let a=null,c=null;const i=(l,u)=>B(void 0,null,function*(){let d=t(l);const h=De(d,u);if(!h){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=n(u,p),a!==null&&d.start(a),c!==null&&d.stop(c)}return o.set(u,d),h?yield e(u,l.offset,d.offset):yield r(u,l.offset,d.offset),yield s(l,u,d),d});return{set start(l){a=l},set stop(l){c=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):i(l,u)}}},yi=e=>n=>(e[0]=n,e[0]),wi={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ci=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=r(c),u=R(R({},wi),i),d=t(l,u),p=s(l)?n():null;super(c,!1,d,p),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(c){if(this._nativeConvolverNode.buffer=c,c===null&&this._nativeConvolverNode.buffer!==null){const i=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=i.createBuffer(1,1,i.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(c){this._nativeConvolverNode.normalize=c}},Ni=(e,n,t)=>()=>{const r=new WeakMap,s=(o,a)=>B(void 0,null,function*(){let c=n(o);if(!De(c,a)){const l={buffer:c.buffer,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,disableNormalization:!c.normalize};c=e(a,l)}return r.set(a,c),At(c)?yield t(o,a,c.inputs[0]):yield t(o,a,c),c});return{render(o,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):s(o,a)}}},bi=()=>new DOMException("","DataCloneError"),Nr=e=>{const{port1:n,port2:t}=new MessageChannel;return new Promise(r=>{const s=()=>{t.onmessage=null,n.close(),t.close(),r()};t.onmessage=()=>s();try{n.postMessage(e,[e])}catch(o){}finally{s()}})},Mi=(e,n,t,r,s,o,a,c,i,l,u)=>(d,h)=>{const p=a(d)?d:o(d);if(s.has(h)){const f=t();return Promise.reject(f)}try{s.add(h)}catch(f){}return n(i,()=>i(p))?p.decodeAudioData(h).then(f=>(Nr(h).catch(()=>{}),n(c,()=>c(f))||u(f),e.add(f),f)):new Promise((f,g)=>{const _=()=>B(void 0,null,function*(){try{yield Nr(h)}catch(E){}}),C=E=>{g(E),_()};try{p.decodeAudioData(h,E=>{typeof E.copyFromChannel!="function"&&(l(E),Qr(E)),e.add(E),_().then(()=>f(E))},E=>{C(E===null?r():E)})}catch(E){C(E)}})},Ii=(e,n,t,r,s,o,a,c)=>(i,l)=>{const u=n.get(i);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(i.context),h=c(d);if(u===l){if(n.delete(i),!h&&a(i)){const p=r(i),{outputs:f}=t(i);for(const g of f)if(Ht(g)){const _=r(g[0]);e(p,_,g[1],g[2])}else{const _=s(g[0]);p.connect(_,g[1])}}}else n.set(i,u-l)},Ti={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Si=(e,n,t,r,s,o,a)=>class extends e{constructor(i,l){const u=s(i),d=R(R({},Ti),l),h=r(u,d),p=o(u),f=p?t(d.maxDelayTime):null;super(i,!1,h,f),this._delayTime=n(this,p,h.delayTime),a(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},ki=(e,n,t,r,s)=>o=>{const a=new WeakMap,c=(i,l)=>B(void 0,null,function*(){let u=t(i);const d=De(u,l);if(!d){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=n(l,h)}return a.set(l,u),d?yield e(l,i.delayTime,u.delayTime):yield r(l,i.delayTime,u.delayTime),yield s(i,l,u),u});return{render(i,l){const u=a.get(l);return u!==void 0?Promise.resolve(u):c(i,l)}}},Ei=e=>(n,t,r,s)=>e(n[s],o=>o[0]===t&&o[1]===r),Ri=e=>"delayTime"in e,Ai=(e,n,t)=>function r(s,o){const a=pn(o)?o:t(e,o);if(Ri(a))return[];if(s[0]===a)return[s];if(s.includes(a))return[];const{outputs:c}=n(a);return Array.from(c).map(i=>r([...s,a],i[0])).reduce((i,l)=>i.concat(l),[])},Fi={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Di=(e,n,t,r,s,o,a,c)=>class extends e{constructor(l,u){const d=o(l),h=R(R({},Fi),u),p=r(d,h),f=a(d),g=f?t():null;super(l,!1,p,g),this._attack=n(this,f,p.attack),this._knee=n(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=n(this,f,p.ratio),this._release=n(this,f,p.release),this._threshold=n(this,f,p.threshold),c(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Pi=(e,n,t,r,s)=>()=>{const o=new WeakMap,a=(c,i)=>B(void 0,null,function*(){let l=t(c);const u=De(l,i);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=n(i,d)}return o.set(i,l),u?(yield e(i,c.attack,l.attack),yield e(i,c.knee,l.knee),yield e(i,c.ratio,l.ratio),yield e(i,c.release,l.release),yield e(i,c.threshold,l.threshold)):(yield r(i,c.attack,l.attack),yield r(i,c.knee,l.knee),yield r(i,c.ratio,l.ratio),yield r(i,c.release,l.release),yield r(i,c.threshold,l.threshold)),yield s(c,i,l),l});return{render(c,i){const l=o.get(i);return l!==void 0?Promise.resolve(l):a(c,i)}}},Oi=()=>new DOMException("","EncodingError"),xi=e=>n=>new Promise((t,r)=>{if(e===null){r(new SyntaxError);return}const s=e.document.head;if(s===null)r(new SyntaxError);else{const o=e.document.createElement("script"),a=new Blob([n],{type:"application/javascript"}),c=URL.createObjectURL(a),i=e.onerror,l=()=>{e.onerror=i,URL.revokeObjectURL(c)};e.onerror=(u,d,h,p,f)=>{if(d===c||d===e.location.href&&h===1&&p===1)return l(),r(f),!1;if(i!==null)return i(u,d,h,p,f)},o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),t()},o.src=c,o.type="module",s.appendChild(o)}}),Li=e=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,s){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=e(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(t,o,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,s){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,o===void 0?null:o,s)}},Bi=e=>(n,t,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(n*t)}},currentTime:{configurable:!0,get(){return n}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},Wi=e=>n=>B(void 0,null,function*(){try{const t=yield fetch(n);if(t.ok)return[yield t.text(),t.url]}catch(t){}throw e()}),Vi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Ui=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=s(c),u=R(R({},Vi),i),d=r(l,u),h=o(l),p=h?t():null;super(c,!1,d,p),this._gain=n(this,h,d.gain,Oe,Le)}get gain(){return this._gain}},$i=(e,n,t,r,s)=>()=>{const o=new WeakMap,a=(c,i)=>B(void 0,null,function*(){let l=t(c);const u=De(l,i);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=n(i,d)}return o.set(i,l),u?yield e(i,c.gain,l.gain):yield r(i,c.gain,l.gain),yield s(c,i,l),l});return{render(c,i){const l=o.get(i);return l!==void 0?Promise.resolve(l):a(c,i)}}},qi=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},zi=e=>n=>{var t;return(t=e.get(n))!==null&&t!==void 0?t:0},ji=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},Fe=()=>new DOMException("","InvalidStateError"),Zi=e=>n=>{const t=e.get(n);if(t===void 0)throw Fe();return t},Gi=(e,n)=>t=>{let r=e.get(t);if(r!==void 0)return r;if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new n(1,1,44100),e.set(t,r),r},_n=()=>new DOMException("","InvalidAccessError"),Xi=e=>{e.getFrequencyResponse=(n=>(t,r,s)=>{if(t.length!==r.length||r.length!==s.length)throw _n();return n.call(e,t,r,s)})(e.getFrequencyResponse)},Yi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Hi=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=r(c),u=s(l),d=R(R({},Yi),i),h=n(l,u?null:c.baseLatency,d),p=u?t(d.feedback,d.feedforward):null;super(c,!1,h,p),Xi(h),this._nativeIIRFilterNode=h,o(this,1)}getFrequencyResponse(c,i,l){return this._nativeIIRFilterNode.getFrequencyResponse(c,i,l)}},no=(e,n,t,r,s,o,a,c,i,l,u)=>{const d=l.length;let h=c;for(let p=0;p<d;p+=1){let f=t[0]*l[p];for(let g=1;g<s;g+=1){const _=h-g&i-1;f+=t[g]*o[_],f-=e[g]*a[_]}for(let g=s;g<r;g+=1)f+=t[g]*o[h-g&i-1];for(let g=s;g<n;g+=1)f-=e[g]*a[h-g&i-1];o[h]=l[p],a[h]=f,h=h+1&i-1,u[p]=f}return h},Qi=(e,n,t,r)=>{const s=t instanceof Float64Array?t:new Float64Array(t),o=r instanceof Float64Array?r:new Float64Array(r),a=s.length,c=o.length,i=Math.min(a,c);if(s[0]!==1){for(let f=0;f<a;f+=1)o[f]/=s[0];for(let f=1;f<c;f+=1)s[f]/=s[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),h=n.createBuffer(e.numberOfChannels,e.length,e.sampleRate),p=e.numberOfChannels;for(let f=0;f<p;f+=1){const g=e.getChannelData(f),_=h.getChannelData(f);u.fill(0),d.fill(0),no(s,a,o,c,i,u,d,0,l,g,_)}return h},Ki=(e,n,t,r,s)=>(o,a)=>{const c=new WeakMap;let i=null;const l=(u,d)=>B(void 0,null,function*(){let h=null,p=n(u);const f=De(p,d);if(d.createIIRFilter===void 0?h=e(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=d.createIIRFilter(a,o)),c.set(d,h===null?p:h),h!==null){if(i===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new t(u.context.destination.channelCount,u.context.length,d.sampleRate);i=(()=>B(void 0,null,function*(){yield r(u,_,_.destination);const C=yield s(_);return Qi(C,d,o,a)}))()}const g=yield i;return h.buffer=g,h.start(0),h}return yield r(u,d,p),p});return{render(u,d){const h=c.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},Ji=(e,n,t,r,s,o)=>a=>(c,i)=>{const l=e.get(c);if(l===void 0){if(!a&&o(c)){const u=r(c),{outputs:d}=t(c);for(const h of d)if(Ht(h)){const p=r(h[0]);n(u,p,h[1],h[2])}else{const p=s(h[0]);u.disconnect(p,h[1])}}e.set(c,i)}else e.set(c,l+i)},el=e=>n=>e!==null&&n instanceof e,tl=e=>n=>e!==null&&typeof e.AudioNode=="function"&&n instanceof e.AudioNode,nl=e=>n=>e!==null&&typeof e.AudioParam=="function"&&n instanceof e.AudioParam,rl=(e,n)=>t=>e(t)||n(t),ol=e=>n=>e!==null&&n instanceof e,sl=e=>e!==null&&e.isSecureContext,al=(e,n,t,r)=>class extends e{constructor(o,a){const c=t(o),i=n(c,a);if(r(c))throw TypeError();super(o,!0,i,null),this._nativeMediaElementAudioSourceNode=i}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},cl={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},il=(e,n,t,r)=>class extends e{constructor(o,a){const c=t(o);if(r(c))throw new TypeError;const i=R(R({},cl),a),l=n(c,i);super(o,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},ll=(e,n,t,r)=>class extends e{constructor(o,a){const c=t(o),i=n(c,a);if(r(c))throw new TypeError;super(o,!0,i,null),this._nativeMediaStreamAudioSourceNode=i}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},ul=(e,n,t)=>class extends e{constructor(s,o){const a=t(s),c=n(a,o);super(s,!0,c,null)}},dl=(e,n,t,r,s,o)=>class extends t{constructor(c,i){super(c),this._nativeContext=c,Zr.set(this,c),r(c)&&s.set(c,new Set),this._destination=new e(this,i),this._listener=n(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const i=typeof c=="function"?o(this,c):null;this._nativeContext.onstatechange=i;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===i?c:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Wn=e=>{const n=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=e.decodeAudioData(n.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch(t){}return!1},hl=(e,n)=>(t,r,s)=>{const o=new Set;return t.connect=(a=>(c,i=0,l=0)=>{const u=o.size===0;if(n(c))return a.call(t,c,i,l),e(o,[c,i,l],d=>d[0]===c&&d[1]===i&&d[2]===l,!0),u&&r(),c;a.call(t,c,i),e(o,[c,i],d=>d[0]===c&&d[1]===i,!0),u&&r()})(t.connect),t.disconnect=(a=>(c,i,l)=>{const u=o.size>0;if(c===void 0)a.apply(t),o.clear();else if(typeof c=="number"){a.call(t,c);for(const h of o)h[1]===c&&o.delete(h)}else{n(c)?a.call(t,c,i,l):a.call(t,c,i);for(const h of o)h[0]===c&&(i===void 0||h[1]===i)&&(l===void 0||h[2]===l)&&o.delete(h)}const d=o.size===0;u&&d&&s()})(t.disconnect),t},pe=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t]&&(e[t]=r)},Me=(e,n)=>{pe(e,n,"channelCount"),pe(e,n,"channelCountMode"),pe(e,n,"channelInterpretation")},br=e=>typeof e.getFloatTimeDomainData=="function",fl=e=>{e.getFloatTimeDomainData=n=>{const t=new Uint8Array(n.length);e.getByteTimeDomainData(t);const r=Math.max(t.length,e.fftSize);for(let s=0;s<r;s+=1)n[s]=(t[s]-128)*.0078125;return n}},pl=(e,n)=>(t,r)=>{const s=t.createAnalyser();if(Me(s,r),!(r.maxDecibels>r.minDecibels))throw n();return pe(s,r,"fftSize"),pe(s,r,"maxDecibels"),pe(s,r,"minDecibels"),pe(s,r,"smoothingTimeConstant"),e(br,()=>br(s))||fl(s),s},vl=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,ye=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t].value&&(e[t].value=r)},ml=e=>{e.start=(n=>{let t=!1;return(r=0,s=0,o)=>{if(t)throw Fe();n.call(e,r,s,o),t=!0}})(e.start)},Xn=e=>{e.start=(n=>(t=0,r=0,s)=>{if(typeof s=="number"&&s<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");n.call(e,t,r,s)})(e.start)},Yn=e=>{e.stop=(n=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");n.call(e,t)})(e.stop)},gl=(e,n,t,r,s,o,a,c,i,l,u)=>(d,h)=>{const p=d.createBufferSource();return Me(p,h),ye(p,h,"playbackRate"),pe(p,h,"buffer"),pe(p,h,"loop"),pe(p,h,"loopEnd"),pe(p,h,"loopStart"),n(t,()=>t(d))||ml(p),n(r,()=>r(d))||i(p),n(s,()=>s(d))||l(p,d),n(o,()=>o(d))||Xn(p),n(a,()=>a(d))||u(p,d),n(c,()=>c(d))||Yn(p),e(d,p),p},_l=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,yl=(e,n)=>(t,r,s)=>{const o=t.destination;if(o.channelCount!==r)try{o.channelCount=r}catch(c){}s&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const a=e(t,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return n(a,"channelCount",c=>()=>c.call(a),c=>i=>{c.call(a,i);try{o.channelCount=i}catch(l){if(i>o.maxChannelCount)throw l}}),n(a,"channelCountMode",c=>()=>c.call(a),c=>i=>{c.call(a,i),o.channelCountMode=i}),n(a,"channelInterpretation",c=>()=>c.call(a),c=>i=>{c.call(a,i),o.channelInterpretation=i}),Object.defineProperty(a,"maxChannelCount",{get:()=>o.maxChannelCount}),a.connect(o),a},wl=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,Cl=(e,n)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*n))))),ro=(e,n)=>{const t=e.createBiquadFilter();return Me(t,n),ye(t,n,"Q"),ye(t,n,"detune"),ye(t,n,"frequency"),ye(t,n,"gain"),pe(t,n,"type"),t},Nl=(e,n)=>(t,r)=>{const s=t.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&n(t,s),Me(s,r),s},bl=e=>{const n=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>n,set:t=>{if(t!==n)throw Fe()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Fe()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Fe()}})},Hn=(e,n)=>{const t=e.createChannelSplitter(n.numberOfOutputs);return Me(t,n),bl(t),t},Ml=(e,n,t,r,s)=>(o,a)=>{if(o.createConstantSource===void 0)return t(o,a);const c=o.createConstantSource();return Me(c,a),ye(c,a,"offset"),n(r,()=>r(o))||Xn(c),n(s,()=>s(o))||Yn(c),e(o,c),c},Ft=(e,n)=>(e.connect=n.connect.bind(n),e.disconnect=n.disconnect.bind(n),e),Il=(e,n,t,r)=>(s,c)=>{var i=c,{offset:o}=i,a=bt(i,["offset"]);const l=s.createBuffer(1,2,44100),u=n(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=t(s,J(R({},a),{gain:o})),h=l.getChannelData(0);h[0]=1,h[1]=1,u.buffer=l,u.loop=!0;const p={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(_){d.channelCount=_},get channelCountMode(){return d.channelCountMode},set channelCountMode(_){d.channelCountMode=_},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(_){d.channelInterpretation=_},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return u.onended},set onended(_){u.onended=_},addEventListener(..._){return u.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return u.dispatchEvent(_[0])},removeEventListener(..._){return u.removeEventListener(_[0],_[1],_[2])},start(_=0){u.start.call(u,_)},stop(_=0){u.stop.call(u,_)}},f=()=>u.connect(d),g=()=>u.disconnect(d);return e(s,u),r(Ft(p,d),f,g)},Tl=(e,n)=>(t,r)=>{const s=t.createConvolver();if(Me(s,r),r.disableNormalization===s.normalize&&(s.normalize=!r.disableNormalization),pe(s,r,"buffer"),r.channelCount>2||(n(s,"channelCount",o=>()=>o.call(s),o=>a=>{if(a>2)throw e();return o.call(s,a)}),r.channelCountMode==="max"))throw e();return n(s,"channelCountMode",o=>()=>o.call(s),o=>a=>{if(a==="max")throw e();return o.call(s,a)}),s},oo=(e,n)=>{const t=e.createDelay(n.maxDelayTime);return Me(t,n),ye(t,n,"delayTime"),t},Sl=e=>(n,t)=>{const r=n.createDynamicsCompressor();if(Me(r,t),t.channelCount>2||t.channelCountMode==="max")throw e();return ye(r,t,"attack"),ye(r,t,"knee"),ye(r,t,"ratio"),ye(r,t,"release"),ye(r,t,"threshold"),r},ze=(e,n)=>{const t=e.createGain();return Me(t,n),ye(t,n,"gain"),t},kl=e=>(n,t,r)=>{if(n.createIIRFilter===void 0)return e(n,t,r);const s=n.createIIRFilter(r.feedforward,r.feedback);return Me(s,r),s};function El(e,n){const t=n[0]*n[0]+n[1]*n[1];return[(e[0]*n[0]+e[1]*n[1])/t,(e[1]*n[0]-e[0]*n[1])/t]}function Rl(e,n){return[e[0]*n[0]-e[1]*n[1],e[0]*n[1]+e[1]*n[0]]}function Mr(e,n){let t=[0,0];for(let r=e.length-1;r>=0;r-=1)t=Rl(t,n),t[0]+=e[r];return t}const Al=(e,n,t,r)=>(s,o,{channelCount:a,channelCountMode:c,channelInterpretation:i,feedback:l,feedforward:u})=>{const d=Cl(o,s.sampleRate),h=l instanceof Float64Array?l:new Float64Array(l),p=u instanceof Float64Array?u:new Float64Array(u),f=h.length,g=p.length,_=Math.min(f,g);if(f===0||f>20)throw r();if(h[0]===0)throw n();if(g===0||g>20)throw r();if(p[0]===0)throw n();if(h[0]!==1){for(let w=0;w<g;w+=1)p[w]/=h[0];for(let w=1;w<f;w+=1)h[w]/=h[0]}const C=t(s,d,a,a);C.channelCount=a,C.channelCountMode=c,C.channelInterpretation=i;const E=32,S=[],x=[],I=[];for(let w=0;w<a;w+=1){S.push(0);const W=new Float32Array(E),q=new Float32Array(E);W.fill(0),q.fill(0),x.push(W),I.push(q)}C.onaudioprocess=w=>{const W=w.inputBuffer,q=w.outputBuffer,L=W.numberOfChannels;for(let T=0;T<L;T+=1){const V=W.getChannelData(T),b=q.getChannelData(T);S[T]=no(h,f,p,g,_,x[T],I[T],S[T],E,V,b)}};const N=s.sampleRate/2;return Ft({get bufferSize(){return d},get channelCount(){return C.channelCount},set channelCount(w){C.channelCount=w},get channelCountMode(){return C.channelCountMode},set channelCountMode(w){C.channelCountMode=w},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(w){C.channelInterpretation=w},get context(){return C.context},get inputs(){return[C]},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},addEventListener(...w){return C.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return C.dispatchEvent(w[0])},getFrequencyResponse(w,W,q){if(w.length!==W.length||W.length!==q.length)throw e();const L=w.length;for(let T=0;T<L;T+=1){const V=-Math.PI*(w[T]/N),b=[Math.cos(V),Math.sin(V)],P=Mr(p,b),A=Mr(h,b),Z=El(P,A);W[T]=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]),q[T]=Math.atan2(Z[1],Z[0])}},removeEventListener(...w){return C.removeEventListener(w[0],w[1],w[2])}},C)},Fl=(e,n)=>e.createMediaElementSource(n.mediaElement),Dl=(e,n)=>{const t=e.createMediaStreamDestination();return Me(t,n),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},Pl=(e,{mediaStream:n})=>{const t=n.getAudioTracks();t.sort((o,a)=>o.id<a.id?-1:o.id>a.id?1:0);const r=t.slice(0,1),s=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(s,"mediaStream",{value:n}),s},Ol=(e,n)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const s=new MediaStream([r]),o=t.createMediaStreamSource(s);if(r.kind!=="audio")throw e();if(n(t))throw new TypeError;return o},xl=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,Ll=(e,n,t,r,s,o)=>(a,c)=>{const i=a.createOscillator();return Me(i,c),ye(i,c,"detune"),ye(i,c,"frequency"),c.periodicWave!==void 0?i.setPeriodicWave(c.periodicWave):pe(i,c,"type"),n(t,()=>t(a))||Xn(i),n(r,()=>r(a))||o(i,a),n(s,()=>s(a))||Yn(i),e(a,i),i},Bl=e=>(n,t)=>{const r=n.createPanner();return r.orientationX===void 0?e(n,t):(Me(r,t),ye(r,t,"orientationX"),ye(r,t,"orientationY"),ye(r,t,"orientationZ"),ye(r,t,"positionX"),ye(r,t,"positionY"),ye(r,t,"positionZ"),pe(r,t,"coneInnerAngle"),pe(r,t,"coneOuterAngle"),pe(r,t,"coneOuterGain"),pe(r,t,"distanceModel"),pe(r,t,"maxDistance"),pe(r,t,"panningModel"),pe(r,t,"refDistance"),pe(r,t,"rolloffFactor"),r)},Wl=(e,n,t,r,s,o,a,c,i,l)=>(u,q)=>{var L=q,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:p,distanceModel:f,maxDistance:g,orientationX:_,orientationY:C,orientationZ:E,panningModel:S,positionX:x,positionY:I,positionZ:N,refDistance:y,rolloffFactor:w}=L,W=bt(L,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);const T=u.createPanner();if(W.channelCount>2||W.channelCountMode==="max")throw a();Me(T,W);const V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},b=t(u,J(R({},V),{channelInterpretation:"speakers",numberOfInputs:6})),P=r(u,J(R({},W),{gain:1})),A=r(u,J(R({},V),{gain:1})),Z=r(u,J(R({},V),{gain:0})),U=r(u,J(R({},V),{gain:0})),O=r(u,J(R({},V),{gain:0})),m=r(u,J(R({},V),{gain:0})),v=r(u,J(R({},V),{gain:0})),F=s(u,256,6,1),z=o(u,J(R({},V),{curve:new Float32Array([1,1]),oversample:"none"}));let Q=[_,C,E],H=[x,I,N];const $=new Float32Array(1);F.onaudioprocess=({inputBuffer:D})=>{const se=[i(D,$,0),i(D,$,1),i(D,$,2)];se.some((le,ne)=>le!==Q[ne])&&(T.setOrientation(...se),Q=se);const ie=[i(D,$,3),i(D,$,4),i(D,$,5)];ie.some((le,ne)=>le!==H[ne])&&(T.setPosition(...ie),H=ie)},Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(U.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(m.gain,"defaultValue",{get:()=>0}),Object.defineProperty(v.gain,"defaultValue",{get:()=>0});const k={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(D){if(D>2)throw a();P.channelCount=D,T.channelCount=D},get channelCountMode(){return T.channelCountMode},set channelCountMode(D){if(D==="max")throw a();P.channelCountMode=D,T.channelCountMode=D},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(D){P.channelInterpretation=D,T.channelInterpretation=D},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(D){T.coneInnerAngle=D},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(D){T.coneOuterAngle=D},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(D){if(D<0||D>1)throw n();T.coneOuterGain=D},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(D){T.distanceModel=D},get inputs(){return[P]},get maxDistance(){return T.maxDistance},set maxDistance(D){if(D<0)throw new RangeError;T.maxDistance=D},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return A.gain},get orientationY(){return Z.gain},get orientationZ(){return U.gain},get panningModel(){return T.panningModel},set panningModel(D){T.panningModel=D},get positionX(){return O.gain},get positionY(){return m.gain},get positionZ(){return v.gain},get refDistance(){return T.refDistance},set refDistance(D){if(D<0)throw new RangeError;T.refDistance=D},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(D){if(D<0)throw new RangeError;T.rolloffFactor=D},addEventListener(...D){return P.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return P.dispatchEvent(D[0])},removeEventListener(...D){return P.removeEventListener(D[0],D[1],D[2])}};d!==k.coneInnerAngle&&(k.coneInnerAngle=d),h!==k.coneOuterAngle&&(k.coneOuterAngle=h),p!==k.coneOuterGain&&(k.coneOuterGain=p),f!==k.distanceModel&&(k.distanceModel=f),g!==k.maxDistance&&(k.maxDistance=g),_!==k.orientationX.value&&(k.orientationX.value=_),C!==k.orientationY.value&&(k.orientationY.value=C),E!==k.orientationZ.value&&(k.orientationZ.value=E),S!==k.panningModel&&(k.panningModel=S),x!==k.positionX.value&&(k.positionX.value=x),I!==k.positionY.value&&(k.positionY.value=I),N!==k.positionZ.value&&(k.positionZ.value=N),y!==k.refDistance&&(k.refDistance=y),w!==k.rolloffFactor&&(k.rolloffFactor=w),(Q[0]!==1||Q[1]!==0||Q[2]!==0)&&T.setOrientation(...Q),(H[0]!==0||H[1]!==0||H[2]!==0)&&T.setPosition(...H);const ee=()=>{P.connect(T),e(P,z,0,0),z.connect(A).connect(b,0,0),z.connect(Z).connect(b,0,1),z.connect(U).connect(b,0,2),z.connect(O).connect(b,0,3),z.connect(m).connect(b,0,4),z.connect(v).connect(b,0,5),b.connect(F).connect(u.destination)},oe=()=>{P.disconnect(T),c(P,z,0,0),z.disconnect(A),A.disconnect(b),z.disconnect(Z),Z.disconnect(b),z.disconnect(U),U.disconnect(b),z.disconnect(O),O.disconnect(b),z.disconnect(m),m.disconnect(b),z.disconnect(v),v.disconnect(b),b.disconnect(F),F.disconnect(u.destination)};return l(Ft(k,T),ee,oe)},Vl=e=>(n,{disableNormalization:t,imag:r,real:s})=>{const o=r instanceof Float32Array?r:new Float32Array(r),a=s instanceof Float32Array?s:new Float32Array(s),c=n.createPeriodicWave(a,o,{disableNormalization:t});if(Array.from(r).length<2)throw e();return c},yn=(e,n,t,r)=>e.createScriptProcessor(n,t,r),Ul=(e,n)=>(t,r)=>{const s=r.channelCountMode;if(s==="clamped-max")throw n();if(t.createStereoPanner===void 0)return e(t,r);const o=t.createStereoPanner();return Me(o,r),ye(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>s,set:a=>{if(a!==s)throw n()}}),o},$l=(e,n,t,r,s,o)=>{const c=new Float32Array([1,1]),i=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u=J(R({},l),{oversample:"none"}),d=(f,g,_,C)=>{const E=new Float32Array(16385),S=new Float32Array(16385);for(let W=0;W<16385;W+=1){const q=W/16384*i;E[W]=Math.cos(q),S[W]=Math.sin(q)}const x=t(f,J(R({},l),{gain:0})),I=r(f,J(R({},u),{curve:E})),N=r(f,J(R({},u),{curve:c})),y=t(f,J(R({},l),{gain:0})),w=r(f,J(R({},u),{curve:S}));return{connectGraph(){g.connect(x),g.connect(N.inputs===void 0?N:N.inputs[0]),g.connect(y),N.connect(_),_.connect(I.inputs===void 0?I:I.inputs[0]),_.connect(w.inputs===void 0?w:w.inputs[0]),I.connect(x.gain),w.connect(y.gain),x.connect(C,0,0),y.connect(C,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(N.inputs===void 0?N:N.inputs[0]),g.disconnect(y),N.disconnect(_),_.disconnect(I.inputs===void 0?I:I.inputs[0]),_.disconnect(w.inputs===void 0?w:w.inputs[0]),I.disconnect(x.gain),w.disconnect(y.gain),x.disconnect(C,0,0),y.disconnect(C,0,1)}}},h=(f,g,_,C)=>{const E=new Float32Array(16385),S=new Float32Array(16385),x=new Float32Array(16385),I=new Float32Array(16385),N=Math.floor(16385/2);for(let Z=0;Z<16385;Z+=1)if(Z>N){const U=(Z-N)/(16384-N)*i;E[Z]=Math.cos(U),S[Z]=Math.sin(U),x[Z]=0,I[Z]=1}else{const U=Z/(16384-N)*i;E[Z]=1,S[Z]=0,x[Z]=Math.cos(U),I[Z]=Math.sin(U)}const y=n(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),w=t(f,J(R({},l),{gain:0})),W=r(f,J(R({},u),{curve:E})),q=t(f,J(R({},l),{gain:0})),L=r(f,J(R({},u),{curve:S})),T=r(f,J(R({},u),{curve:c})),V=t(f,J(R({},l),{gain:0})),b=r(f,J(R({},u),{curve:x})),P=t(f,J(R({},l),{gain:0})),A=r(f,J(R({},u),{curve:I}));return{connectGraph(){g.connect(y),g.connect(T.inputs===void 0?T:T.inputs[0]),y.connect(w,0),y.connect(q,0),y.connect(V,1),y.connect(P,1),T.connect(_),_.connect(W.inputs===void 0?W:W.inputs[0]),_.connect(L.inputs===void 0?L:L.inputs[0]),_.connect(b.inputs===void 0?b:b.inputs[0]),_.connect(A.inputs===void 0?A:A.inputs[0]),W.connect(w.gain),L.connect(q.gain),b.connect(V.gain),A.connect(P.gain),w.connect(C,0,0),V.connect(C,0,0),q.connect(C,0,1),P.connect(C,0,1)},disconnectGraph(){g.disconnect(y),g.disconnect(T.inputs===void 0?T:T.inputs[0]),y.disconnect(w,0),y.disconnect(q,0),y.disconnect(V,1),y.disconnect(P,1),T.disconnect(_),_.disconnect(W.inputs===void 0?W:W.inputs[0]),_.disconnect(L.inputs===void 0?L:L.inputs[0]),_.disconnect(b.inputs===void 0?b:b.inputs[0]),_.disconnect(A.inputs===void 0?A:A.inputs[0]),W.disconnect(w.gain),L.disconnect(q.gain),b.disconnect(V.gain),A.disconnect(P.gain),w.disconnect(C,0,0),V.disconnect(C,0,0),q.disconnect(C,0,1),P.disconnect(C,0,1)}}},p=(f,g,_,C,E)=>{if(g===1)return d(f,_,C,E);if(g===2)return h(f,_,C,E);throw s()};return(f,S)=>{var x=S,{channelCount:g,channelCountMode:_,pan:C}=x,E=bt(x,["channelCount","channelCountMode","pan"]);if(_==="max")throw s();const I=e(f,J(R({},E),{channelCount:1,channelCountMode:_,numberOfInputs:2})),N=t(f,J(R({},E),{channelCount:g,channelCountMode:_,gain:1})),y=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:C});let{connectGraph:w,disconnectGraph:W}=p(f,g,N,y,I);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});const q={get bufferSize(){},get channelCount(){return N.channelCount},set channelCount(b){N.channelCount!==b&&(L&&W(),{connectGraph:w,disconnectGraph:W}=p(f,b,N,y,I),L&&w()),N.channelCount=b},get channelCountMode(){return N.channelCountMode},set channelCountMode(b){if(b==="clamped-max"||b==="max")throw s();N.channelCountMode=b},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(b){N.channelInterpretation=b},get context(){return N.context},get inputs(){return[N]},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},get pan(){return y.gain},addEventListener(...b){return N.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return N.dispatchEvent(b[0])},removeEventListener(...b){return N.removeEventListener(b[0],b[1],b[2])}};let L=!1;const T=()=>{w(),L=!0},V=()=>{W(),L=!1};return o(Ft(q,I),T,V)}},ql=(e,n,t,r,s,o,a)=>(c,i)=>{const l=c.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&c.createGain().gain.automationRate===void 0)return t(c,i);Me(l,i);const u=i.curve===null||i.curve instanceof Float32Array?i.curve:new Float32Array(i.curve);if(u!==null&&u.length<2)throw n();pe(l,{curve:u},"curve"),pe(l,i,"oversample");let d=null,h=!1;return a(l,"curve",g=>()=>g.call(l),g=>_=>(g.call(l,_),h&&(r(_)&&d===null?d=e(c,l):!r(_)&&d!==null&&(d(),d=null)),_)),s(l,()=>{h=!0,r(l.curve)&&(d=e(c,l))},()=>{h=!1,d!==null&&(d(),d=null)})},zl=(e,n,t,r,s)=>(o,l)=>{var u=l,{curve:a,oversample:c}=u,i=bt(u,["curve","oversample"]);const d=o.createWaveShaper(),h=o.createWaveShaper();Me(d,i),Me(h,i);const p=t(o,J(R({},i),{gain:1})),f=t(o,J(R({},i),{gain:-1})),g=t(o,J(R({},i),{gain:1})),_=t(o,J(R({},i),{gain:-1}));let C=null,E=!1,S=null;const x={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(y){p.channelCount=y,f.channelCount=y,d.channelCount=y,g.channelCount=y,h.channelCount=y,_.channelCount=y},get channelCountMode(){return d.channelCountMode},set channelCountMode(y){p.channelCountMode=y,f.channelCountMode=y,d.channelCountMode=y,g.channelCountMode=y,h.channelCountMode=y,_.channelCountMode=y},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(y){p.channelInterpretation=y,f.channelInterpretation=y,d.channelInterpretation=y,g.channelInterpretation=y,h.channelInterpretation=y,_.channelInterpretation=y},get context(){return d.context},get curve(){return S},set curve(y){if(y!==null&&y.length<2)throw n();if(y===null)d.curve=y,h.curve=y;else{const w=y.length,W=new Float32Array(w+2-w%2),q=new Float32Array(w+2-w%2);W[0]=y[0],q[0]=-y[w-1];const L=Math.ceil((w+1)/2),T=(w+1)/2-1;for(let V=1;V<L;V+=1){const b=V/L*T,P=Math.floor(b),A=Math.ceil(b);W[V]=P===A?y[P]:(1-(b-P))*y[P]+(1-(A-b))*y[A],q[V]=P===A?-y[w-1-P]:-((1-(b-P))*y[w-1-P])-(1-(A-b))*y[w-1-A]}W[L]=w%2===1?y[L-1]:(y[L-2]+y[L-1])/2,d.curve=W,h.curve=q}S=y,E&&(r(S)&&C===null?C=e(o,p):C!==null&&(C(),C=null))},get inputs(){return[p]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(y){d.oversample=y,h.oversample=y},addEventListener(...y){return p.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return p.dispatchEvent(y[0])},removeEventListener(...y){return p.removeEventListener(y[0],y[1],y[2])}};a!==null&&(x.curve=a instanceof Float32Array?a:new Float32Array(a)),c!==x.oversample&&(x.oversample=c);const I=()=>{p.connect(d).connect(g),p.connect(f).connect(h).connect(_).connect(g),E=!0,r(S)&&(C=e(o,p))},N=()=>{p.disconnect(d),d.disconnect(g),p.disconnect(f),f.disconnect(h),h.disconnect(_),_.disconnect(g),E=!1,C!==null&&(C(),C=null)};return s(Ft(x,g),I,N)},$e=()=>new DOMException("","NotSupportedError"),jl={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Zl=(e,n,t,r,s,o,a)=>class extends e{constructor(i,l){const u=s(i),d=R(R({},jl),l),h=t(u,d),p=o(u),f=p?r():null,g=i.sampleRate/2;super(i,!1,h,f),this._detune=n(this,p,h.detune,153600,-153600),this._frequency=n(this,p,h.frequency,g,-g),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(i){const l=typeof i=="function"?a(this,i):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?i:u}get type(){return this._nativeOscillatorNode.type}set type(i){this._nativeOscillatorNode.type=i,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(i){this._nativeOscillatorNode.setPeriodicWave(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=i)}start(i=0){if(this._nativeOscillatorNode.start(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=i),this.context.state!=="closed"){St(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Ke(this)&&Xt(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(i=0){this._nativeOscillatorNode.stop(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=i)}},Gl=(e,n,t,r,s)=>()=>{const o=new WeakMap;let a=null,c=null,i=null;const l=(u,d)=>B(void 0,null,function*(){let h=t(u);const p=De(h,d);if(!p){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:a===null?void 0:a,type:h.type};h=n(d,f),c!==null&&h.start(c),i!==null&&h.stop(i)}return o.set(d,h),p?(yield e(d,u.detune,h.detune),yield e(d,u.frequency,h.frequency)):(yield r(d,u.detune,h.detune),yield r(d,u.frequency,h.frequency)),yield s(u,d,h),h});return{set periodicWave(u){a=u},set start(u){c=u},set stop(u){i=u},render(u,d){const h=o.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},Xl={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Yl=(e,n,t,r,s,o,a)=>class extends e{constructor(i,l){const u=s(i),d=R(R({},Xl),l),h=t(u,d),p=o(u),f=p?r():null;super(i,!1,h,f),this._nativePannerNode=h,this._orientationX=n(this,p,h.orientationX,Oe,Le),this._orientationY=n(this,p,h.orientationY,Oe,Le),this._orientationZ=n(this,p,h.orientationZ,Oe,Le),this._positionX=n(this,p,h.positionX,Oe,Le),this._positionY=n(this,p,h.positionY,Oe,Le),this._positionZ=n(this,p,h.positionZ,Oe,Le),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(i){this._nativePannerNode.coneInnerAngle=i}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(i){this._nativePannerNode.coneOuterAngle=i}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(i){this._nativePannerNode.coneOuterGain=i}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(i){this._nativePannerNode.distanceModel=i}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(i){this._nativePannerNode.maxDistance=i}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(i){this._nativePannerNode.panningModel=i}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(i){this._nativePannerNode.refDistance=i}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(i){this._nativePannerNode.rolloffFactor=i}},Hl=(e,n,t,r,s,o,a,c,i,l)=>()=>{const u=new WeakMap;let d=null;const h=(p,f)=>B(void 0,null,function*(){let g=null,_=o(p);const C={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},E=J(R({},C),{coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor}),S=De(_,f);if("bufferSize"in _)g=r(f,J(R({},C),{gain:1}));else if(!S){const x=J(R({},E),{orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value});_=s(f,x)}if(u.set(f,g===null?_:g),g!==null){if(d===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new a(6,p.context.length,f.sampleRate),T=n(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});T.connect(L.destination),d=(()=>B(void 0,null,function*(){const V=yield Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((b,P)=>B(void 0,null,function*(){const A=t(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:P===0?1:0});return yield c(L,b,A.offset),A})));for(let b=0;b<6;b+=1)V[b].connect(T,0,b),V[b].start(0);return l(L)}))()}const x=yield d,I=r(f,J(R({},C),{gain:1}));yield i(p,f,I);const N=[];for(let L=0;L<x.numberOfChannels;L+=1)N.push(x.getChannelData(L));let y=[N[0][0],N[1][0],N[2][0]],w=[N[3][0],N[4][0],N[5][0]],W=r(f,J(R({},C),{gain:1})),q=s(f,J(R({},E),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:w[0],positionY:w[1],positionZ:w[2]}));I.connect(W).connect(q.inputs[0]),q.connect(g);for(let L=128;L<x.length;L+=128){const T=[N[0][L],N[1][L],N[2][L]],V=[N[3][L],N[4][L],N[5][L]];if(T.some((b,P)=>b!==y[P])||V.some((b,P)=>b!==w[P])){y=T,w=V;const b=L/f.sampleRate;W.gain.setValueAtTime(0,b),W=r(f,J(R({},C),{gain:0})),q=s(f,J(R({},E),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:w[0],positionY:w[1],positionZ:w[2]})),W.gain.setValueAtTime(1,b),I.connect(W).connect(q.inputs[0]),q.connect(g)}}return g}return S?(yield e(f,p.orientationX,_.orientationX),yield e(f,p.orientationY,_.orientationY),yield e(f,p.orientationZ,_.orientationZ),yield e(f,p.positionX,_.positionX),yield e(f,p.positionY,_.positionY),yield e(f,p.positionZ,_.positionZ)):(yield c(f,p.orientationX,_.orientationX),yield c(f,p.orientationY,_.orientationY),yield c(f,p.orientationZ,_.orientationZ),yield c(f,p.positionX,_.positionX),yield c(f,p.positionY,_.positionY),yield c(f,p.positionZ,_.positionZ)),At(_)?yield i(p,f,_.inputs[0]):yield i(p,f,_),_});return{render(p,f){const g=u.get(f);return g!==void 0?Promise.resolve(g):h(p,f)}}},Ql={disableNormalization:!1},Kl=(e,n,t,r)=>class so{constructor(o,a){const c=n(o),i=r(R(R({},Ql),a)),l=e(c,i);return t.add(l),l}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===so.prototype||t.has(o)}},Jl=(e,n)=>(t,r,s)=>(e(r).replay(s),n(r,t,s)),eu=(e,n,t)=>(r,s,o)=>B(void 0,null,function*(){const a=e(r);yield Promise.all(a.activeInputs.map((c,i)=>Array.from(c).map(d=>B(void 0,[d],function*([l,u]){const p=yield n(l).render(l,s),f=r.context.destination;!t(l)&&(r!==f||!t(r))&&p.connect(o,u,i)}))).reduce((c,i)=>[...c,...i],[]))}),tu=(e,n,t)=>(r,s,o)=>B(void 0,null,function*(){const a=n(r);yield Promise.all(Array.from(a.activeInputs).map(l=>B(void 0,[l],function*([c,i]){const d=yield e(c).render(c,s);t(c)||d.connect(o,i)})))}),nu=(e,n,t,r)=>s=>e(Wn,()=>Wn(s))?Promise.resolve(e(r,r)).then(o=>{if(!o){const a=t(s,512,0,1);s.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>s.currentTime,a.connect(s.destination)}return s.startRendering()}):new Promise(o=>{const a=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=c=>{a.disconnect(),o(c.renderedBuffer)},a.connect(s.destination),s.startRendering()}),ru=e=>(n,t)=>e.set(n,t),ou={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},su=(e,n,t,r,s,o)=>class extends e{constructor(c,i){const l=s(c),u=R(R({},ou),i),d=t(l,u),h=o(l),p=h?r():null;super(c,!1,d,p),this._pan=n(this,h,d.pan)}get pan(){return this._pan}},au=(e,n,t,r,s)=>()=>{const o=new WeakMap,a=(c,i)=>B(void 0,null,function*(){let l=t(c);const u=De(l,i);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=n(i,d)}return o.set(i,l),u?yield e(i,c.pan,l.pan):yield r(i,c.pan,l.pan),At(l)?yield s(c,i,l.inputs[0]):yield s(c,i,l),l});return{render(c,i){const l=o.get(i);return l!==void 0?Promise.resolve(l):a(c,i)}}},cu=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch(n){return!1}return!0},iu=(e,n)=>()=>B(void 0,null,function*(){if(e===null)return!0;if(n===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new n(1,128,44100),s=URL.createObjectURL(t);let o=!1,a=!1;try{yield r.audioWorklet.addModule(s);const c=new e(r,"a",{numberOfOutputs:0}),i=r.createOscillator();c.port.onmessage=()=>o=!0,c.onprocessorerror=()=>a=!0,i.connect(c),i.start(0),yield r.startRendering(),yield new Promise(l=>setTimeout(l))}catch(c){}finally{URL.revokeObjectURL(s)}return o&&!a}),lu=(e,n)=>()=>{if(n===null)return Promise.resolve(!1);const t=new n(1,1,44100),r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{t.oncomplete=()=>{r.disconnect(),s(t.currentTime!==0)},t.startRendering()})},uu=()=>new DOMException("","UnknownError"),du={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},hu=(e,n,t,r,s,o,a)=>class extends e{constructor(i,l){const u=s(i),d=R(R({},du),l),h=t(u,d),f=o(u)?r():null;super(i,!0,h,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(i){if(i===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(i.length<2)throw n();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=i}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(i){this._nativeWaveShaperNode.oversample=i}},fu=(e,n,t)=>()=>{const r=new WeakMap,s=(o,a)=>B(void 0,null,function*(){let c=n(o);if(!De(c,a)){const l={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,curve:c.curve,oversample:c.oversample};c=e(a,l)}return r.set(a,c),At(c)?yield t(o,a,c.inputs[0]):yield t(o,a,c),c});return{render(o,a){const c=r.get(a);return c!==void 0?Promise.resolve(c):s(o,a)}}},pu=()=>typeof window=="undefined"?null:window,vu=(e,n)=>t=>{t.copyFromChannel=(r,s,o=0)=>{const a=e(o),c=e(s);if(c>=t.numberOfChannels)throw n();const i=t.length,l=t.getChannelData(c),u=r.length;for(let d=a<0?-a:0;d+a<i&&d<u;d+=1)r[d]=l[d+a]},t.copyToChannel=(r,s,o=0)=>{const a=e(o),c=e(s);if(c>=t.numberOfChannels)throw n();const i=t.length,l=t.getChannelData(c),u=r.length;for(let d=a<0?-a:0;d+a<i&&d<u;d+=1)l[d+a]=r[d]}},mu=e=>n=>{n.copyFromChannel=(t=>(r,s,o=0)=>{const a=e(o),c=e(s);if(a<n.length)return t.call(n,r,c,a)})(n.copyFromChannel),n.copyToChannel=(t=>(r,s,o=0)=>{const a=e(o),c=e(s);if(a<n.length)return t.call(n,r,c,a)})(n.copyToChannel)},gu=e=>(n,t)=>{const r=t.createBuffer(1,1,44100);n.buffer===null&&(n.buffer=r),e(n,"buffer",s=>()=>{const o=s.call(n);return o===r?null:o},s=>o=>s.call(n,o===null?r:o))},_u=(e,n)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const s=t.createBufferSource();n(r,()=>{const c=r.numberOfInputs;for(let i=0;i<c;i+=1)s.connect(r,0,i)},()=>s.disconnect(r))},ao=(e,n,t)=>e.copyFromChannel===void 0?e.getChannelData(t)[0]:(e.copyFromChannel(n,t),n[0]),co=e=>{if(e===null)return!1;const n=e.length;return n%2!==0?e[Math.floor(n/2)]!==0:e[n/2-1]+e[n/2]!==0},Qt=(e,n,t,r)=>{let s=e;for(;!s.hasOwnProperty(n);)s=Object.getPrototypeOf(s);const{get:o,set:a}=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(e,n,{get:t(o),set:r(a)})},yu=e=>J(R({},e),{channelCount:e.numberOfOutputs}),wu=e=>{const{imag:n,real:t}=e;return n===void 0?t===void 0?J(R({},e),{imag:[0,0],real:[0,0]}):J(R({},e),{imag:Array.from(t,()=>0),real:t}):t===void 0?J(R({},e),{imag:n,real:Array.from(n,()=>0)}):J(R({},e),{imag:n,real:t})},io=(e,n,t)=>{try{e.setValueAtTime(n,t)}catch(r){if(r.code!==9)throw r;io(e,n,t+1e-7)}},Cu=e=>{const n=e.createBufferSource();n.start();try{n.start()}catch(t){return!0}return!1},Nu=e=>{const n=e.createBufferSource(),t=e.createBuffer(1,1,44100);n.buffer=t;try{n.start(0,1)}catch(r){return!1}return!0},bu=e=>{const n=e.createBufferSource();n.start();try{n.stop()}catch(t){return!1}return!0},Qn=e=>{const n=e.createOscillator();try{n.start(-1)}catch(t){return t instanceof RangeError}return!1},lo=e=>{const n=e.createBuffer(1,1,44100),t=e.createBufferSource();t.buffer=n,t.start(),t.stop();try{return t.stop(),!0}catch(r){return!1}},Kn=e=>{const n=e.createOscillator();try{n.stop(-1)}catch(t){return t instanceof RangeError}return!1},Mu=e=>{e.start=(n=>(t=0,r=0,s)=>{const o=e.buffer,a=o===null?r:Math.min(o.duration,r);o!==null&&a>o.duration-.5/e.context.sampleRate?n.call(e,t,0,0):n.call(e,t,a,s)})(e.start)},uo=(e,n)=>{const t=n.createGain();e.connect(t);const r=(s=>()=>{s.call(e,t),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),Ft(e,t),e.stop=(s=>{let o=!1;return(a=0)=>{if(o)try{s.call(e,a)}catch(c){t.gain.setValueAtTime(0,a)}else s.call(e,a),o=!0}})(e.stop)},Kt=(e,n)=>t=>{const r={value:e};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof n=="function"?n.call(e,t):n.handleEvent.call(e,t)},Iu=_c(vt),Tu=Mc(vt),Su=Ei(gn),ho=new WeakMap,ku=zi(ho),nt=ci(new Map,new WeakMap),Ge=pu(),fo=pl(nt,pt),po=qi(Be),ke=eu(Be,po,ft),Eu=kc(fo,ge,ke),fe=Zi(Zr),mt=xl(Ge),de=ol(mt),vo=new WeakMap,mo=Li(Kt),Jt=_l(Ge),go=el(Jt),_o=tl(Ge),Ru=nl(Ge),Vn=wl(Ge),Ce=ei(yc($r),bc(Iu,Tu,vn,Su,mn,Be,ku,Gt,ge,vt,Ke,ft,un),nt,Ji(On,mn,Be,ge,zt,Ke),pt,_n,$e,Ii(vn,On,Be,ge,zt,fe,Ke,de),Ai(vo,Be,ut),mo,fe,go,_o,Ru,de,Vn),Au=Sc(Ce,Eu,pt,fo,fe,de),yo=new WeakSet,Ir=vl(Ge),wo=yi(new Uint32Array(1)),Co=vu(wo,pt),No=mu(wo),Fu=Rc(yo,nt,$e,Ir,mt,cu(Ir),Co,No),wn=Ic(ze),bo=tu(po,Yt,ft),rt=pi(bo),en=gl(wn,nt,Cu,Nu,bu,Qn,lo,Kn,Mu,gu(Qt),uo),ot=Jl(ji(Yt),bo),Du=Dc(rt,en,ge,ot,ke),Ye=ti(wc(zr),vo,jr,ni,hc,fc,pc,vc,mc,Fn,Vr,Jt,io),Pu=Fc(Ce,Du,Ye,Fe,en,fe,de,Kt),Ou=qc(Ce,zc,pt,Fe,yl(ze,Qt),fe,de,ke),xu=ai(rt,ro,ge,ot,ke),gt=ru(ho),Lu=si(Ce,Ye,xu,_n,ro,fe,de,gt),Dt=hl(vt,_o),Bu=_u(Fe,Dt),Pt=Nl(Jt,Bu),Wu=ui(Pt,ge,ke),Vu=li(Ce,Wu,Pt,fe,de),Uu=fi(Hn,ge,ke),$u=hi(Ce,Uu,Hn,fe,de,yu),qu=Il(wn,en,ze,Dt),Cn=Ml(wn,nt,qu,Qn,Kn),zu=_i(rt,Cn,ge,ot,ke),ju=gi(Ce,Ye,zu,Cn,fe,de,Kt),Mo=Tl($e,Qt),Zu=Ni(Mo,ge,ke),Gu=Ci(Ce,Zu,Mo,fe,de,gt),Xu=ki(rt,oo,ge,ot,ke),Yu=Si(Ce,Ye,Xu,oo,fe,de,gt),Io=Sl($e),Hu=Pi(rt,Io,ge,ot,ke),Qu=Di(Ce,Ye,Hu,Io,$e,fe,de,gt),Ku=$i(rt,ze,ge,ot,ke),Ju=Ui(Ce,Ye,Ku,ze,fe,de),ed=Al(_n,Fe,yn,$e),To=nu(nt,ze,yn,lu(ze,mt)),td=Ki(en,ge,mt,ke,To),nd=kl(ed),rd=Hi(Ce,nd,td,fe,de,gt),od=jc(Ye,Pt,Cn,yn,$e,ao,de,Qt),sd=new WeakMap,ad=dl(Ou,od,mo,de,sd,Kt),So=Ll(wn,nt,Qn,lo,Kn,uo),cd=Gl(rt,So,ge,ot,ke),id=Zl(Ce,Ye,So,cd,fe,de,Kt),ko=vi(en),ld=zl(ko,Fe,ze,co,Dt),Nn=ql(ko,Fe,ld,co,Dt,Jt,Qt),ud=Wl(vn,Fe,Pt,ze,yn,Nn,$e,mn,ao,Dt),Eo=Bl(ud),dd=Hl(rt,Pt,Cn,ze,Eo,ge,mt,ot,ke,To),hd=Yl(Ce,Ye,Eo,dd,fe,de,gt),fd=Vl(pt),pd=Kl(fd,fe,new WeakSet,wu),vd=$l(Pt,Hn,ze,Nn,$e,Dt),Ro=Ul(vd,$e),md=au(rt,Ro,ge,ot,ke),gd=su(Ce,Ye,Ro,md,fe,de),_d=fu(Nn,ge,ke),yd=hu(Ce,Fe,Nn,_d,fe,de,gt),wd=sl(Ge),Cd=Bi(Ge),Nd=new WeakMap,bd=Gi(Nd,mt),Md=wd?Nc(nt,$e,xi(Ge),Cd,Wi(gc),fe,bd,de,Vn,new WeakMap,new WeakMap,iu(Vn,mt),Ge):void 0,Id=rl(go,de),Td=Mi(yo,nt,bi,Oi,new WeakSet,fe,Id,Ln,Wn,Co,No),Sd=ri(Md,Au,Fu,Pu,Lu,Vu,$u,ju,Gu,Td,Yu,Qu,Ju,rd,ad,id,hd,pd,gd,yd),kd=al(Ce,Fl,fe,de),Ed=il(Ce,Dl,fe,de),Rd=ll(Ce,Pl,fe,de),Ad=Ol(Fe,de),Fd=ul(Ce,Ad,fe),Ao=$c(Sd,Fe,$e,uu,kd,Ed,Rd,Fd,Jt),Fo=[],Dd=()=>{Fo.forEach(e=>e())};function Pd(){let e,n;var t=new Ao({latencyHint:"playback"});e=t.createAnalyser(),e.fftSize=2048;const r=()=>{t.close()};let s=!1;const o=[],a=()=>{s||requestAnimationFrame(()=>{var l=e.frequencyBinCount;n=new Uint8Array(l),e.getByteFrequencyData(n),o.forEach(u=>u(n)),a()})};return{load:(l,u,d=()=>{})=>{let h;(()=>fetch(l).then(f=>f.arrayBuffer()).then(f=>new Promise((g,_)=>{t.decodeAudioData(f,g,C=>{console.log("decodeAudioData-er",C),_(C)})})).then(f=>h=f))().then(function(){const f=t.createBufferSource();f.buffer=h,f.connect(e),e.connect(t.destination),console.log("source.start"),f.start(),a(),f.onended=()=>{console.log("source.onended"),s=!0,d()},Fo.push(()=>{f.stop()})}).catch(f=>{console.log("getdata-err",f)})},change:(l=()=>{})=>o.push(l),destroy:r}}const Od=()=>{let e=navigator.mediaDevices||{};return e.getUserMedia||(e=navigator,e.getUserMedia||(e.getUserMedia=e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia)),e.getUserMedia?e:!1};let Do=[],Po=[];const xd=()=>new Promise((n,t)=>{const r=Od();if(r.getUserMedia){let s={audio:!0};r.getUserMedia(s).then(n,t)}else t({err:!0,_msg:"不支持的浏览器"})});function Ld(){var e=["audio/mpeg","audio/webm","audio/mp4","audio/wav","audio/ogg","audio/flac","audio/m4a","audio/mp3","audio/mpga","audio/oga"];let n;for(var t in e){let r=MediaRecorder.isTypeSupported(e[t]);r&&!n&&(console.log("Is "+e[t]+" supported? "+(r?"Yes!":"Nope :(")),n=e[t])}return n}const Bd=()=>{Do.forEach(({stream:e,mediaRecorder:n,destroy:t})=>{e.getTracks().forEach(r=>r.stop()),t()}),Po.forEach(e=>e.close())};function Wd(e={}){const{MediaPermission:n=xd(),readover:t=()=>{},change:r=()=>{},stop:s=()=>{},error:o=()=>{}}=e;let a,c,i,l=[];try{let u=!1;const d=()=>{u||(requestAnimationFrame(d),a.getByteTimeDomainData(i),r(i))},h=()=>u=!0;let p=Ld();n.then(f=>{console.log("---MediaPermission--");const g=new Ao,_=g.createMediaStreamSource(f);Po.push(g);const C=()=>f.getAudioTracks().forEach(x=>x.stop());c=new MediaRecorder(f,{mimeType:p});const E=()=>{h(),C(),g.close()};Do.push({stream:f,mediaRecorder:c,destroy:E}),c.addEventListener("dataavailable",x=>{console.log("mediaRecorder-dataavailable:",x),l.push(x.data)}),c.addEventListener("start",()=>{console.timeEnd("调用开始录制"),console.log("mediaRecorder-start:"),l=[]}),c.addEventListener("stop",()=>{const x=new Blob(l,{type:"audio/mp4"});s(x),E(),l=[]}),a=g.createAnalyser(),a.fftSize=2048;const S=a.frequencyBinCount;i=new Uint8Array(S),_.connect(a),g.suspend(),t({start:()=>{d(),g.resume(),console.time("调用开始录制"),c.start()},stop:()=>{g.suspend(),c.stop()},destroy:E})}).catch(f=>{if(console.log("stream-errr",f),f=="Requested device not found")return o({_msg:"未找到录音设备"});o(f)})}catch(u){console.log("mediaDevices-errr",u),u.message.includes("MediaRecorder")&&(u._msg="不支持的浏览器"),o(u)}}const Vd={class:"VerbalChat tpage"},Ud={class:"footer"},$d={key:0,class:"tipText"},qd={key:1,class:"beta"},zd={__name:"VerbalChat",props:["show"],emits:["send","update:show"],setup(e,{emit:n}){const t=n,r=te(!0),s=te(!0),o=te(""),a=te(!1),c=te(!1),i=te(!1),l=te(),u=te(),d=lt();let h=!1,p,f;ce(()=>{if(!a.value&&!i.value)return"点击说话";if(a.value)return"我说完了";if(c.value)return"回答中";if(i.value)return"响应中"});const g=()=>{h=!0,t("update:show",!1)};let _;const C=({type:b,data:P})=>{l.value&&l.value.draw({type:b,data:P})},E=()=>l.value&&l.value.clear(),S=b=>B(this,null,function*(){var P,A,Z,U,O,m;if(!(i.value||h)){i.value=!0;try{(P=u.value)==null||P.change("loading"),E(),f=Pd();const v=new FormData;v.append("file",b);const F=yield rc(v).catch(D=>(console.log("err",D),""));if(console.log("text",F),!F){f.destroy(),o.value="无法识别",i.value=!1,(A=u.value)==null||A.change("noraml");return}const z=yield new Promise(D=>t("send",{type:"text",text:F,over:D}));if([403].includes(z.response.status)){f.destroy(),i.value=!1,(Z=u.value)==null||Z.change("noraml");return}const Q=d.currMsg.length-1,H=d.currMsg[Q];console.log("chat 响应完成",H);const $={tts1:{input:H.content,speed:"1.0"}},k=yield nc($).catch(D=>(console.log("err",D),""));if(!k){f.destroy(),o.value="出了点问题",i.value=!1,(U=u.value)==null||U.change("noraml");return}(O=u.value)==null||O.change(""),c.value=!0,console.log("语音 播放");const ee=new Blob([k],{type:"audio/mpeg"}),oe=window.URL.createObjectURL(ee);f.change(D=>C({data:D})),yield new Promise(D=>f.load(oe,"",D)),console.log("播放 完成"),c.value=!1}catch(v){console.log("流程出现错误",v)}setTimeout(()=>{E(),setTimeout(()=>E(),10)},10),(m=u.value)==null||m.change("noraml"),i.value=!1}}),x=()=>new Promise((b,P)=>{_==null||_.destroy(),Wd({MediaPermission:p,readover:A=>{_=A,console.log("准备"),b(!0)},change:A=>{a.value&&C({data:A})},stop:A=>S(A),error:P})}),I=()=>{var b;r.value=!1,!(c.value||i.value||a.value)&&(console.log("开始录制"),s.value=!1,o.value="",(b=u.value)==null||b.change(""),a.value=!0,_&&_.start())},N=()=>{s.value=!0,console.log("停止录制"),a.value=!1,_&&_.stop()};let y=60*1e3,w=1e3,W,q=!1;const L=()=>B(this,null,function*(){if(console.log("touchstart"),q)return;q=!0;let b=Date.now();if(!(yield x().catch(Z=>(console.log("打开权限-err",Z),o.value=Z._msg||"请重新授权",q=!1,!1)))||!q)return;o.value="";const A=Date.now()-b;if(console.log("---dt---",A),A>w){q=!1,console.log("仅授权"),_==null||_.destroy();return}I(),clearTimeout(W),W=setTimeout(()=>{console.log(y+"ms时长到了, 自动回答"),T()},y)}),T=()=>{console.log("touchend"),q=!1,clearTimeout(W),N()},V=()=>B(this,null,function*(){});return Xe(()=>{var b;h=!1,(b=u.value)==null||b.change("noraml")}),tt(()=>{f==null||f.destroy(),Dd(),Bd()}),(b,P)=>(X(),K("div",Vd,[M("div",{class:"vCWrapper",onClick:V},[ae(ic,{class:"processLoading2",ref_key:"plRef",ref:u},null,512),ae(ac,{class:"VerbalCanvas",ref_key:"verCanvas",ref:l},null,512),P[0]||(P[0]=M("div",{class:"top_beta"},[dn("「语音版"),M("sup",null,"beta"),dn("」")],-1))]),M("div",Ud,[M("div",{class:he(["guanji_wrapper",{active:!s.value}])},[M("div",{class:"guanji",onTouchstart:Je(L,["prevent"]),onTouchend:Je(T,["prevent"])},P[1]||(P[1]=[M("span",{class:"iconfont icon-audio-fill"},null,-1)]),32),P[2]||(P[2]=M("div",{class:"guanji_dot"},null,-1))],2),o.value?(X(),K("div",$d,Se(o.value),1)):ve("",!0),r.value?(X(),K("div",qd,"长按开始说话，松开结束说话")):ve("",!0)]),M("div",{class:"close",onClick:g},P[3]||(P[3]=[M("span",{class:"iconfont icon-close"},null,-1)]))]))}},jd=Ve(zd,[["__scopeId","data-v-705c46f8"]]);const Zd={__name:"AsideRouter",setup(e){const n=jt(),t=kt(),r=et("resize"),s=te(""),o=ce(()=>n.meta.fixed||"left"),a=ce(()=>n.meta.asideRouter&&!r.smallRef.value),c=qn(()=>{a.value&&setTimeout(()=>s.value="show")}),i=l=>B(this,null,function*(){s.value="",yield ht(300),!window[n.meta.variableName]&&t.push({name:"dialogue"})});return tt(c),(l,u)=>{const d=Ar("router-view");return a.value?(X(),K("div",{key:0,class:"AsideRouter",onClick:i},[M("div",{class:he(["aside",[s.value,o.value]]),onClick:u[0]||(u[0]=Je(()=>{},["stop"]))},[ae(d)],2)])):ve("",!0)}}};const Gd={__name:"ContentRouter",setup(e){const n=jt(),t=kt(),r=et("resize"),s=ce(()=>n.meta.contentRouter),o=te(""),a=qn(()=>{s.value&&r.smallRef.value&&setTimeout(()=>o.value="show")}),c=()=>B(this,null,function*(){o.value="",yield ht(300),!window[n.meta.variableName]&&t.push({name:"dialogue"})});return tt(a),(i,l)=>{const u=Ar("router-view");return s.value?(X(),K("div",{key:0,class:he(["contentRouter",{mobile:j(r).smallRef.value}]),onClick:c},[M("div",{class:he(["wrapper",o.value])},[l[1]||(l[1]=M("div",{class:"top"},[M("span",{class:"iconfont icon-jiantou_liebiaozhankai_o"})],-1)),M("div",{class:"conetnt",onClick:l[0]||(l[0]=Je(()=>{},["stop"]))},[ae(u)])],2)],2)):ve("",!0)}}},Xd=Ve(Gd,[["__scopeId","data-v-b0183522"]]);const Yd={class:"NewDialoguePc"},Hd={class:"avatar"},Qd=["src"],Kd={class:"title"},Jd={class:"intro"},eh={class:"cTags"},th=["onClick"],nh={key:1,class:"flex"},rh={class:"border line2"},oh=["onClick"],sh={__name:"NewDialoguePc",emits:["send"],setup(e,{emit:n}){const t=et("resize"),r=lt(),s=cs(),o=n,a=ce(()=>t.IDERef.value?r.friends.filter(u=>u).find(u=>u.roleType===Fr.coding_assistant)||s.plugin||{}:r.currFriendInfo),c=ce(()=>{const u=[];if(!a.value.conversationStart)return u;const d=a.value.conversationStart.length;if(!(!t.smallRef.value||d<=2))for(let p=0;p<4;p++){const f=a.value.conversationStart[p]||a.value.conversationStart[p/d],g=Math.floor(p/2);p%2==0&&(u[g]=[]),u[g].push(f)}return u}),i=ce(()=>(a.value.commentTags||[]).map(({color:d,bgColor:h,name:p})=>({name:p,style:{color:d,backgroundColor:h}}))),l=u=>{o("send",{type:"newDialogue",text:u})};return(u,d)=>(X(),K("div",Yd,[M("div",Hd,[M("img",{src:a.value.avatar||j($n),alt:""},null,8,Qd)]),M("div",Kd,Se(a.value.name),1),M("div",Jd,Se(a.value.welcome),1),M("div",eh,[(X(!0),K(Ae,null,qe(i.value,h=>(X(),K("div",{class:"tagItem",key:h.name,style:Re(h.style)},Se(h.name),5))),128))]),M("div",{class:he(["stars",{small:j(t).smallRef.value}])},[c.value.length?(X(),K("div",nh,[M("div",rh,[ae(ms,{list:c.value},{default:We(({text:h})=>[(X(!0),K(Ae,null,qe(h,p=>(X(),K("div",{class:"border",key:p,onClick:f=>l(p)},Se(p),9,oh))),128))]),_:1},8,["list"])])])):(X(),K("div",{key:0,class:he(["flex",{small:j(t).smallRef.value}])},[(X(!0),K(Ae,null,qe(a.value.conversationStart,(h,p)=>(X(),K("div",{class:"border hover_bg",key:p,onClick:f=>l(h)},Se(h),9,th))),128))],2))],2)]))}},ah=Ve(sh,[["__scopeId","data-v-40225145"]]);var Oo={};(function e(n,t,r,s){var o=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",c=function(){if(!n.OffscreenCanvas)return!1;var m=new OffscreenCanvas(1,1),v=m.getContext("2d");v.fillRect(0,0,1,1);var F=m.transferToImageBitmap();try{v.createPattern(F,"no-repeat")}catch(z){return!1}return!0}();function i(){}function l(m){var v=t.exports.Promise,F=v!==void 0?v:n.Promise;return typeof F=="function"?new F(m):(m(i,i),null)}var u=function(m,v){return{transform:function(F){if(m)return F;if(v.has(F))return v.get(F);var z=new OffscreenCanvas(F.width,F.height),Q=z.getContext("2d");return Q.drawImage(F,0,0),v.set(F,z),z},clear:function(){v.clear()}}}(c,new Map),d=function(){var m=Math.floor(16.666666666666668),v,F,z={},Q=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(v=function(H){var $=Math.random();return z[$]=requestAnimationFrame(function k(ee){Q===ee||Q+m-1<ee?(Q=ee,delete z[$],H()):z[$]=requestAnimationFrame(k)}),$},F=function(H){z[H]&&cancelAnimationFrame(z[H])}):(v=function(H){return setTimeout(H,m)},F=function(H){return clearTimeout(H)}),{frame:v,cancel:F}}(),h=function(){var m,v,F={};function z(Q){function H($,k){Q.postMessage({options:$||{},callback:k})}Q.init=function(k){var ee=k.transferControlToOffscreen();Q.postMessage({canvas:ee},[ee])},Q.fire=function(k,ee,oe){if(v)return H(k,null),v;var D=Math.random().toString(36).slice(2);return v=l(function(se){function ie(le){le.data.callback===D&&(delete F[D],Q.removeEventListener("message",ie),v=null,u.clear(),oe(),se())}Q.addEventListener("message",ie),H(k,D),F[D]=ie.bind(null,{data:{callback:D}})}),v},Q.reset=function(){Q.postMessage({reset:!0});for(var k in F)F[k](),delete F[k]}}return function(){if(m)return m;if(!r&&o){var Q=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{m=new Worker(URL.createObjectURL(new Blob([Q])))}catch(H){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",H),null}z(m)}return m}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function f(m,v){return v?v(m):m}function g(m){return m!=null}function _(m,v,F){return f(m&&g(m[v])?m[v]:p[v],F)}function C(m){return m<0?0:Math.floor(m)}function E(m,v){return Math.floor(Math.random()*(v-m))+m}function S(m){return parseInt(m,16)}function x(m){return m.map(I)}function I(m){var v=String(m).replace(/[^0-9a-f]/gi,"");return v.length<6&&(v=v[0]+v[0]+v[1]+v[1]+v[2]+v[2]),{r:S(v.substring(0,2)),g:S(v.substring(2,4)),b:S(v.substring(4,6))}}function N(m){var v=_(m,"origin",Object);return v.x=_(v,"x",Number),v.y=_(v,"y",Number),v}function y(m){m.width=document.documentElement.clientWidth,m.height=document.documentElement.clientHeight}function w(m){var v=m.getBoundingClientRect();m.width=v.width,m.height=v.height}function W(m){var v=document.createElement("canvas");return v.style.position="fixed",v.style.top="0px",v.style.left="0px",v.style.pointerEvents="none",v.style.zIndex=m,v}function q(m,v,F,z,Q,H,$,k,ee){m.save(),m.translate(v,F),m.rotate(H),m.scale(z,Q),m.arc(0,0,1,$,k,ee),m.restore()}function L(m){var v=m.angle*(Math.PI/180),F=m.spread*(Math.PI/180);return{x:m.x,y:m.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:m.startVelocity*.5+Math.random()*m.startVelocity,angle2D:-v+(.5*F-Math.random()*F),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:m.color,shape:m.shape,tick:0,totalTicks:m.ticks,decay:m.decay,drift:m.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:m.gravity*3,ovalScalar:.6,scalar:m.scalar,flat:m.flat}}function T(m,v){v.x+=Math.cos(v.angle2D)*v.velocity+v.drift,v.y+=Math.sin(v.angle2D)*v.velocity+v.gravity,v.velocity*=v.decay,v.flat?(v.wobble=0,v.wobbleX=v.x+10*v.scalar,v.wobbleY=v.y+10*v.scalar,v.tiltSin=0,v.tiltCos=0,v.random=1):(v.wobble+=v.wobbleSpeed,v.wobbleX=v.x+10*v.scalar*Math.cos(v.wobble),v.wobbleY=v.y+10*v.scalar*Math.sin(v.wobble),v.tiltAngle+=.1,v.tiltSin=Math.sin(v.tiltAngle),v.tiltCos=Math.cos(v.tiltAngle),v.random=Math.random()+2);var F=v.tick++/v.totalTicks,z=v.x+v.random*v.tiltCos,Q=v.y+v.random*v.tiltSin,H=v.wobbleX+v.random*v.tiltCos,$=v.wobbleY+v.random*v.tiltSin;if(m.fillStyle="rgba("+v.color.r+", "+v.color.g+", "+v.color.b+", "+(1-F)+")",m.beginPath(),a&&v.shape.type==="path"&&typeof v.shape.path=="string"&&Array.isArray(v.shape.matrix))m.fill(Z(v.shape.path,v.shape.matrix,v.x,v.y,Math.abs(H-z)*.1,Math.abs($-Q)*.1,Math.PI/10*v.wobble));else if(v.shape.type==="bitmap"){var k=Math.PI/10*v.wobble,ee=Math.abs(H-z)*.1,oe=Math.abs($-Q)*.1,D=v.shape.bitmap.width*v.scalar,se=v.shape.bitmap.height*v.scalar,ie=new DOMMatrix([Math.cos(k)*ee,Math.sin(k)*ee,-Math.sin(k)*oe,Math.cos(k)*oe,v.x,v.y]);ie.multiplySelf(new DOMMatrix(v.shape.matrix));var le=m.createPattern(u.transform(v.shape.bitmap),"no-repeat");le.setTransform(ie),m.globalAlpha=1-F,m.fillStyle=le,m.fillRect(v.x-D/2,v.y-se/2,D,se),m.globalAlpha=1}else if(v.shape==="circle")m.ellipse?m.ellipse(v.x,v.y,Math.abs(H-z)*v.ovalScalar,Math.abs($-Q)*v.ovalScalar,Math.PI/10*v.wobble,0,2*Math.PI):q(m,v.x,v.y,Math.abs(H-z)*v.ovalScalar,Math.abs($-Q)*v.ovalScalar,Math.PI/10*v.wobble,0,2*Math.PI);else if(v.shape==="star")for(var ne=Math.PI/2*3,Ie=4*v.scalar,Ne=8*v.scalar,Pe=v.x,Ue=v.y,je=5,xe=Math.PI/je;je--;)Pe=v.x+Math.cos(ne)*Ne,Ue=v.y+Math.sin(ne)*Ne,m.lineTo(Pe,Ue),ne+=xe,Pe=v.x+Math.cos(ne)*Ie,Ue=v.y+Math.sin(ne)*Ie,m.lineTo(Pe,Ue),ne+=xe;else m.moveTo(Math.floor(v.x),Math.floor(v.y)),m.lineTo(Math.floor(v.wobbleX),Math.floor(Q)),m.lineTo(Math.floor(H),Math.floor($)),m.lineTo(Math.floor(z),Math.floor(v.wobbleY));return m.closePath(),m.fill(),v.tick<v.totalTicks}function V(m,v,F,z,Q){var H=v.slice(),$=m.getContext("2d"),k,ee,oe=l(function(D){function se(){k=ee=null,$.clearRect(0,0,z.width,z.height),u.clear(),Q(),D()}function ie(){r&&!(z.width===s.width&&z.height===s.height)&&(z.width=m.width=s.width,z.height=m.height=s.height),!z.width&&!z.height&&(F(m),z.width=m.width,z.height=m.height),$.clearRect(0,0,z.width,z.height),H=H.filter(function(le){return T($,le)}),H.length?k=d.frame(ie):se()}k=d.frame(ie),ee=se});return{addFettis:function(D){return H=H.concat(D),oe},canvas:m,promise:oe,reset:function(){k&&d.cancel(k),ee&&ee()}}}function b(m,v){var F=!m,z=!!_(v||{},"resize"),Q=!1,H=_(v,"disableForReducedMotion",Boolean),$=o&&!!_(v||{},"useWorker"),k=$?h():null,ee=F?y:w,oe=m&&k?!!m.__confetti_initialized:!1,D=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,se;function ie(ne,Ie,Ne){for(var Pe=_(ne,"particleCount",C),Ue=_(ne,"angle",Number),je=_(ne,"spread",Number),xe=_(ne,"startVelocity",Number),tn=_(ne,"decay",Number),Ot=_(ne,"gravity",Number),bn=_(ne,"drift",Number),xt=_(ne,"colors",x),nn=_(ne,"ticks",Number),_t=_(ne,"shapes"),Lt=_(ne,"scalar"),Mn=!!_(ne,"flat"),rn=N(ne),on=Pe,He=[],yt=m.width*rn.x,In=m.height*rn.y;on--;)He.push(L({x:yt,y:In,angle:Ue,spread:je,startVelocity:xe,color:xt[on%xt.length],shape:_t[E(0,_t.length)],ticks:nn,decay:tn,gravity:Ot,drift:bn,scalar:Lt,flat:Mn}));return se?se.addFettis(He):(se=V(m,He,ee,Ie,Ne),se.promise)}function le(ne){var Ie=H||_(ne,"disableForReducedMotion",Boolean),Ne=_(ne,"zIndex",Number);if(Ie&&D)return l(function(xe){xe()});F&&se?m=se.canvas:F&&!m&&(m=W(Ne),document.body.appendChild(m)),z&&!oe&&ee(m);var Pe={width:m.width,height:m.height};k&&!oe&&k.init(m),oe=!0,k&&(m.__confetti_initialized=!0);function Ue(){if(k){var xe={getBoundingClientRect:function(){if(!F)return m.getBoundingClientRect()}};ee(xe),k.postMessage({resize:{width:xe.width,height:xe.height}});return}Pe.width=Pe.height=null}function je(){se=null,z&&(Q=!1,n.removeEventListener("resize",Ue)),F&&m&&(document.body.contains(m)&&document.body.removeChild(m),m=null,oe=!1)}return z&&!Q&&(Q=!0,n.addEventListener("resize",Ue,!1)),k?k.fire(ne,Pe,je):ie(ne,Pe,je)}return le.reset=function(){k&&k.reset(),se&&se.reset()},le}var P;function A(){return P||(P=b(null,{useWorker:!0,resize:!0})),P}function Z(m,v,F,z,Q,H,$){var k=new Path2D(m),ee=new Path2D;ee.addPath(k,new DOMMatrix(v));var oe=new Path2D;return oe.addPath(ee,new DOMMatrix([Math.cos($)*Q,Math.sin($)*Q,-Math.sin($)*H,Math.cos($)*H,F,z])),oe}function U(m){if(!a)throw new Error("path confetti are not supported in this browser");var v,F;typeof m=="string"?v=m:(v=m.path,F=m.matrix);var z=new Path2D(v),Q=document.createElement("canvas"),H=Q.getContext("2d");if(!F){for(var $=1e3,k=$,ee=$,oe=0,D=0,se,ie,le=0;le<$;le+=2)for(var ne=0;ne<$;ne+=2)H.isPointInPath(z,le,ne,"nonzero")&&(k=Math.min(k,le),ee=Math.min(ee,ne),oe=Math.max(oe,le),D=Math.max(D,ne));se=oe-k,ie=D-ee;var Ie=10,Ne=Math.min(Ie/se,Ie/ie);F=[Ne,0,0,Ne,-Math.round(se/2+k)*Ne,-Math.round(ie/2+ee)*Ne]}return{type:"path",path:v,matrix:F}}function O(m){var v,F=1,z="#000000",Q='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof m=="string"?v=m:(v=m.text,F="scalar"in m?m.scalar:F,Q="fontFamily"in m?m.fontFamily:Q,z="color"in m?m.color:z);var H=10*F,$=""+H+"px "+Q,k=new OffscreenCanvas(H,H),ee=k.getContext("2d");ee.font=$;var oe=ee.measureText(v),D=Math.ceil(oe.actualBoundingBoxRight+oe.actualBoundingBoxLeft),se=Math.ceil(oe.actualBoundingBoxAscent+oe.actualBoundingBoxDescent),ie=2,le=oe.actualBoundingBoxLeft+ie,ne=oe.actualBoundingBoxAscent+ie;D+=ie+ie,se+=ie+ie,k=new OffscreenCanvas(D,se),ee=k.getContext("2d"),ee.font=$,ee.fillStyle=z,ee.fillText(v,le,ne);var Ie=1/F;return{type:"bitmap",bitmap:k.transferToImageBitmap(),matrix:[Ie,0,0,Ie,-D*Ie/2,-se*Ie/2]}}t.exports=function(){return A().apply(this,arguments)},t.exports.reset=function(){A().reset()},t.exports.create=b,t.exports.shapeFromPath=U,t.exports.shapeFromText=O})(function(){return typeof window!="undefined"?window:typeof self!="undefined"?self:this||{}}(),Oo,!1);Oo.exports.create;const ch=e=>B(void 0,null,function*(){return e.value.style.opacity="0",{recover:()=>{e.value.style.opacity="1"}}});const ih={key:0,class:"aside"},lh={class:"d_content",style:{height:"1%"}},uh={class:"top_bar flex_b flex_sx_center"},dh={class:"flex"},hh={class:"iconfont icon-delete"},fh={class:"iconfont icon-share"},ph={key:0,class:"list"},vh={class:"right flex"},mh={class:"msg_content_wrapper"},gh={class:"newTopic_wrapper"},Rn=50,_h={__name:"index",setup(e){const t=Tr().appContext.config.globalProperties.$bus,r=et("resize"),{historyRef:s,addMsgGrounp:o,useChat:a,useLogin:c,isNew:i,newChatType:l,messageList:u,saveChatMsg:d,getChatMsg:h,delChatMsg:p,createChat:f,delChat:g,newType1Data:_,isNewTopic:C,cellect:E}=Wr,{receive:S,send:x,clearReceive:I}=Er(),{showToast:N,closeWatch:y,clearWatch:w,uid:W}=Un();let q="",L=!1,T={need:!1};const V=jt(),b=kt(),P=Zt(),A=te(null),Z=te(!1),U=te(!0);let O=te(!1);const m=te(!1),v=te(a.sending),F=te(0),z=kr({current:1,size:Rn}),{scrollRef:Q,scrollToBottom:H,scrollToBottomIfAtBottom:$}=gs(),{scolllDom:k,scroll:ee,addScrollFun:oe}=Ss({listDom:Q,type:"top"}),D=()=>m.value=!1;window.useChat=a,an(v,()=>{a.setSending(v.value),H(),v.value||(console.log("回答完成，更新算力信息"),c.getUser(!0))});const se=()=>{ie.value&&!["dialogue"].includes(V.name)||Ut(()=>A.value&&A.value.textareaUp(!0,!0))};ce(()=>a.friends.find(G=>G.voiceChat)||{}),an(()=>V.query.fid,G=>G&&se()),an(()=>V.query.id,(G,Y)=>{V.query.id&&(F.value=0,["temp"].includes(G)?Ne(V.query.nType?1:0):Ot())});const ie=ce(()=>!1);let le=new AbortController;const ne=ce(()=>v.value?"no-drop":"pointer"),Ie=()=>1,Ne=(G=0)=>{if(console.log("addNew",G),v.value||!["dialogue","d_history"].includes(V.name))return;l.value=G;const Y=(re=()=>{})=>{a.triggerChat(""),re();let ue=a.currFriend;r.IDERef.value&&(ue=Ie(),a.setFriend(ue));const me={id:a.getCurrUid,fid:ue};b.replace({query:me}),setTimeout(()=>se(),200)};if(l.value==1){if(C.value)return;C.value=!0,ch(Q).then(({recover:re})=>{Y(()=>{}),a.updateChatInfo(a.currUid,{isNewTopic:!0}),a.isWeb||_.value.forEach(({chat:ue})=>ue.forEach(me=>a.addMsg(me))),console.log("dddd"),re(),l.value=0})}else Y()};let Pe=!1;const Ue=G=>B(this,null,function*(){const{reload:Y,id:re,fid:ue}=V.query;if((Y||G)&&!Pe){Pe=!0;const me={id:re,fid:ue};yield b.replace({query:me}),setTimeout(()=>{kn(),console.log("刷新了")},10)}});an(()=>V.query.reload,()=>{Ue()});const je=re=>B(this,[re],function*({type:G,payload:Y}){G==="logout"?Ne():G==="getData"&&(yield Ot(Y))}),xe=()=>{C.value=!1,H()},tn=(...ue)=>B(this,[...ue],function*({type:G,noScroll:Y,query:re={}}={}){if(Z.value||!["dialogue"].includes(V.name))return;Z.value=!0,console.log("ddd",re.id,V.query.id,a.getCurrUid);const me=re.id||V.query.id||a.getCurrUid;let _e=re.fid||V.query.fid||a.currFriendInfo.id;a.changeUid(me),a.setFriend(_e);const{current:we,pages:st,records:Ze,total:Ee,noData:Bt}=yield h(R({sessionId:me,friendId:_e},z));if(F.value=Ee+2,Ze.length<=0&&z.current==0||Bt)return Z.value=!1,Ne();if(G=="unshift"){const dt=a.currPuseMsg[0];let wt=0;dt&&(wt=document.querySelector(`[msg-id="${dt.id}"]`).offsetTop),a.unshiftChat(me,Ze.reverse()),dt&&Ut(()=>{const Ct=document.querySelector(`[msg-id="${dt.id}"]`);Q.value.scrollTop=Q.value.scrollTop+(Ct.offsetTop-wt)})}else a.updateChat(me,Ze.reverse());O.value=we>=st||a.currChat.message.length>=Ee,!Y&&!["unshift"].includes(G)&&(yield H()),Z.value=!1}),Ot=G=>B(this,null,function*(){if(r.IDERef.value){let Y=Ie();a.setFriend(Y),b.replace({query:{id:a.getCurrUid,fid:Y}})}z.current=1,z.size=F.value||Rn,yield tn(J(R({},G),{type:"new"})),z.size=Rn});a.setFriend(V.query.fid);const bn=()=>{Z.value||O.value||(z.current++,tn({type:"unshift"}))},xt=G=>B(this,null,function*(){const{key:Y,data:re,prompt:ue}=G;if(v.value)return;if(console.log("receive",Y,ue),["show-message-dialog"].includes(Y)){v.value=!1,N("feature",re.message);return}if(["insert-code-to-chat"].includes(Y)){let{assemble:_e,text:we}=ue;A.value&&(q="```\n"+we+"\n```\n",A.value.showInsetArea(_e,()=>{q=""}),setTimeout(()=>se(),300)),v.value=!1;return}v.value=!0,o({content:ue});const{isUpDate:me}=yield yt({prompt:ue,key:Y,isFeature:!0});me&&a.updataMsg({updataObj:{editer:re},index:a.currChat.message.length-1}),console.log("ide 发送消息 完成"),v.value=!1});let nn=te("");Xe(()=>B(this,null,function*(){if(V.query.reload){Ue();return}const G=V.query.id||a.getCurrUid,Y=V.query.type,re=V.query.nType;V.query.inviteCode&&localStorage.setItem("dialogue_inviteCode",V.query.inviteCode),Y==="add"||!G||G=="temp"?Ne(re?1:0):G&&(a.triggerChat(G),a.getCurrUid!=="temp"&&Ot()),v.value=!1,H(),oe(bn),t.on("ide_message",xt),t.on("dialogue_event",je),t.on("friendChange",xe),document.addEventListener("click",D),document.querySelector("#app").classList.add("shadow")})),tt(()=>{C.value=!1,w(),t.off("ide_message",xt),t.off("dialogue_event",je),t.off("friendChange",xe),document.removeEventListener("click",D),v.value&&le.abort()});const _t=(G=()=>{})=>B(this,null,function*(){const Y={id:a.getCurrUid,fid:V.query.fid||a.currFriend};yield b.replace({query:Y}),H(),yield G(),setTimeout(()=>{se()},300)}),Lt=()=>B(this,null,function*(){if(L)return;L=!0;const G=a.currMsg.length-1,Y=a.currMsg[G];if(Y&&Y.role=="assistant"){const{content:re,role:ue,sessionId:me=a.getCurrUid,status:_e}=Y,we={content:re,role:ue,sessionId:me,status:_e};a.updataMsg({updataObj:{loading:!1},index:G}),yield d(we).then(st=>{a.updataMsg({updataObj:st,index:G})})}yield _t(()=>B(this,null,function*(){const re=a.currChatLastAnswer();re&&re.content.includes("```echarts")&&a.updataMsg({updataObj:{showEchart:!0},index:a.currMsg.length-1})})),L=!1}),Mn=()=>{if(!v.value)return;(()=>B(this,null,function*(){T.need&&(yield He()),Lt()}))(),le.abort(),v.value=!1},rn=()=>{a.removeChatMsgEnd();const G=a.removeChatMsgEnd();A.value&&A.value.setText(G[0].content)},on=(G,Y)=>B(this,null,function*(){const[,re,ue]=G.split(":");if(["language-translation","generate-echarts"].includes(ue)&&a.message){v.value=!0,o({content:a.message}),A.value&&A.value.setText(""),yield yt({prompt:a.message,key:ue}),v.value=!1;return}x(re,ue,()=>{},(_e,we)=>{v.value=!1,N("feature",we)})}),He=()=>B(this,null,function*(){const{noSaveUser:G}=T;T={need:!1};const Y=a.currMsg.length-2,re=a.currMsg[Y];if(re&&re.role=="user"&&!G){const{content:ue,role:me,sessionId:_e=a.getCurrUid,attachments:we}=re;yield d({content:ue,role:me,sessionId:_e,attachments:we}).then(Ze=>{a.updataMsg({updataObj:Ze,index:Y})})}}),yt=me=>B(this,[me],function*({prompt:G,key:Y,isFeature:re,noSaveUser:ue}){if(le=new AbortController,H(),setTimeout(()=>H()),a.currChat.temp)try{const _e=G.slice(0,32).trim(),{id:we}=yield f({title:_e,friendId:a.currFriendInfo.id});a.changeUid(we)}catch(_e){console.log("创建新话题错误",_e);return}if(C.value=!1,T.need=!0,T.noSaveUser=ue,qt.value.length){const _e=a.currMsg.length-2,we=a.currMsg[_e];we.attachments=qt.value.map(({url:st,name:Ze,suffix:Ee,size:Bt})=>({name:Ze,mimeType:Ee,size:Bt,url:st})),Ca(),a.updataMsg({updataObj:we,index:_e})}return new Promise((_e,we)=>{const st=a.currChat.temp?"":a.getCurrUid,Ze=a.productId;let Ee=a.currChat.message.filter(Te=>!(Te.welcome||[500].includes(Te.status)));const Bt=a.currMsg[a.currMsg.length-2],dt=Ee[Ee.length-1];!dt.id&&!dt.content&&Ee.pop(),Ee=Ee.map(({role:Te,content:at,attachments:Nt})=>({role:Te,content:at,attachments:Nt})),Ee.length>32&&Ee.splice(0,32-Ee.length),re&&(Ee=[Bt]);let wt=Y||Fr.coding_assistant;r.webRef.value&&(wt=a.currFriendInfo.roleType),c.dot({mt:2,product_id:Ze,role_type:wt});const Ct={options:{roleType:wt,productId:Ze,sessionId:st,messages:Ee},signal:le.signal,controller:le,interruptClear:()=>{},onDownloadProgress:Te=>{try{let at=!0,Nt=a.currChatLastAnswer().content;const Uo=(Te.body||Te._bodyBlob.stream()).getReader();function tr(){return B(this,null,function*(){try{const{done:Sn,value:$o}=yield Uo.read();if(Sn){let nr=()=>B(this,null,function*(){});Te.status===403?(rn(),N("login",Nt),at=!1):Te.status==400?(P.error(Nt),nr=He(),a.removeChatMsgEnd(),yield nr,yield _t()):Te.status==500?(a.updataMsg({updataObj:{status:500},index:a.currChat.message.length-1}),yield He(),yield Lt()):(yield He(),yield Lt()),_e({isUpDate:at,response:Te});return}Nt+=new TextDecoder("utf-8").decode($o),Te.status!==400&&(a.updataMsg({updataObj:{content:Nt,loading:!1},index:a.currChat.message.length-1}),$()),tr()}catch(Sn){console.log("process-err",Sn),_e(!1)}finally{}})}tr()}catch(at){console.log("onDownloadProgress-err",at),at.message=="BodyStreamBuffer was aborted"&&(console.log("回答中-中断"),Ct.interruptClear()),we(at)}},timeOut:()=>B(this,null,function*(){P.error("请求超时"),a.updataMsg({updataObj:{loading:!1},index:a.currChat.message.length-1}),yield He(),yield _t(()=>{const Te=a.currMsg[a.currMsg.length-1];A.value&&A.value.setText(Te.content)}),v.value=!1})};is(Ct).catch(Te=>(Te.message=="The user aborted a request."&&(console.log("未回答-中断"),Ct.interruptClear()),Promise.reject(Te)))})}),In=({type:G,value:Y})=>{G==="verbal"&&(U.value=Y)},Tn=ue=>B(this,[ue],function*({type:G,text:Y,over:re=()=>{}}){if(G.startsWith("feature")){yield on(G);return}v.value=!0,q&&(Y=q+Y,q="",A.value&&A.value.hideInsetArea()),o({content:Y}),i.value=!1,A.value&&A.value.setText("");const me=[{type:"reload",handler:()=>kn()},{type:"show_version",handler:()=>{N("update_system"),y("update_system",we=>B(this,null,function*(){we&&kn()}))}},{type:"info",handler:we=>{a.updataMsg({updataObj:{content:we,loading:!1},index:a.currChat.message.length-1}),$()}}];let _e;_s(Y,me)||(_e=yield yt({prompt:Y})),v.value=!1,re(_e)}),xo=()=>B(this,null,function*(){const G=u.value[u.value.length-1];G&&A.value&&A.value.setText(G.chat[0].content)}),Lo=()=>{if(v.value)return;const G={name:"history"};r.smallRef.value||(G.name="d_history"),b.push(G)},Bo=ue=>B(this,[ue],function*({type:G,item:Y,e:re}){switch(G){case"copyQuize":A.value&&A.value.setText(Y.chat[0].content);break;case"reanswer":v.value=!0;const me=Y.chat[0].content;yield Jn(Y.chat[1]),a.addMsg({role:"assistant",content:"",loading:!0}),yield yt({prompt:me,noSaveUser:!0}),v.value=!1;break;case"collect":E(Y,re);break}}),Jn=G=>B(this,null,function*(){const Y={messageId:G.id};p(Y),a.removeMsg(G)});y("del",G=>B(this,null,function*(){G&&(yield g(),Ne(),A.value&&A.value.setText(""))}));const er=()=>{v.value||N("del")},Wo=()=>B(this,null,function*(){const G=yield ls({sessionId:a.getCurrUid});nn.value=G.shareUrl,N("copy",nn.value,"","",{successText:"分享链接复制成功！"})}),Vo=({type:G})=>{switch(G){case"addNew1":if(i.value)return;Ne(1);break;case"delCurrChat":if(i.value||C.value)return;er();break}};return(G,Y)=>(X(),K("div",{class:he(["dialogue tpage",{pc:!j(r).smallRef.value,small:j(r).smallRef.value}])},[j(r).smallRef.value?ve("",!0):(X(),K("div",ih,[ae(Ts,{hideRight:!j(r).smallRef.value},null,8,["hideRight"]),M("div",{class:"friendList_wrapper",style:Re({height:j(r).webWideRef.value?"calc(100% - 60px)":"calc(100% - 52px - 60px)"})},[ae(Pr)],4),ae(tc)])),M("div",{class:he(["main",{web:!j(r).smallRef.value}])},[ae(Xd),j(V).meta.contentRouter&&!j(r).smallRef.value?ve("",!0):(X(),K(Ae,{key:0},[M("div",lh,[M("div",uh,[M("div",dh,[M("div",{class:"del hover_bg",tabindex:"0",onClick:er,style:Re({cursor:ne.value})},[Wt(M("span",hh,null,512),[[Vt,!j(i)&&!j(C)]])],4),j(c).isLogin?(X(),K("div",{key:0,class:"share hover_bg",tabindex:"1",style:Re({cursor:ne.value}),onClick:Y[0]||(Y[0]=Je(re=>m.value=!m.value,["stop"]))},[Wt(M("span",fh,null,512),[[Vt,!j(i)&&!j(C)]]),m.value?(X(),K("div",ph,[M("div",{class:"item",onClick:Wo},"分享链接")])):ve("",!0)],4)):ve("",!0)]),M("div",vh,[M("div",{ref_key:"historyRef",ref:s,class:"history flex_sx_center hover_bg",tabindex:"0",style:Re({cursor:ne.value}),onClick:Lo},Y[6]||(Y[6]=[M("span",{class:"iconfont icon-history"},null,-1),M("span",{class:"text"},"历史话题",-1)]),4),Wt(M("div",{class:he(["add hover_light2",{isNewTopic:!!j(C)}]),tabindex:"0",onClick:Y[1]||(Y[1]=re=>Ne(1)),style:Re({cursor:ne.value})},[ae(j(An),{size:"30"},{default:We(()=>[ae(j(ks))]),_:1})],6),[[Vt,!j(i)]])])]),M("div",mh,[M("div",{class:"message_wrapper",id:"scrollRef",ref_key:"scrollRef",ref:Q,onScrollPassive:Y[3]||(Y[3]=(...re)=>j(ee)&&j(ee)(...re))},[M("div",{ref_key:"scolllDom",ref:k,class:"message_ul",style:Re({height:j(i)?"calc(100% - 20px)":"auto"})},[(X(!0),K(Ae,null,qe(j(u),(re,ue)=>(X(),It(Dr,{key:re.id,item:re,sending:v.value,"onUpdate:sending":Y[2]||(Y[2]=me=>v.value=me),onChange:Bo,onDelmsg:Jn,end:ue==j(u).length-1},null,8,["item","sending","end"]))),128)),j(i)&&!v.value?(X(),It(ah,{key:0,class:"NewDialogue",onSend:Tn})):ve("",!0)],4)],544),M("div",gh,[Wt(ae(sc,null,null,512),[[Vt,j(l)==1]])])])]),ae(Ha,{ref_key:"buttomC",ref:A,showVerbal:ie.value,vShow:U.value,sending:v.value,"onUpdate:sending":Y[4]||(Y[4]=re=>v.value=re),onSend:Tn,onControl:In,onStop:Mn,onBack:xo,onKeydownEvent:Vo},null,8,["showVerbal","vShow","sending"])],64))],2),ie.value&&U.value?(X(),It(jd,{key:1,onSend:Tn,show:U.value,"onUpdate:show":Y[5]||(Y[5]=re=>U.value=re)},null,8,["show"])):ve("",!0),ae(Zd)],2))}},vf=Ve(_h,[["__scopeId","data-v-31371a3e"]]);export{vf as default};
